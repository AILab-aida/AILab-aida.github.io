<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="AILab-aida" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: true,
    lazyload: false,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="uiautomator2 是一个 python 库，用于 Android 的 UI 自动化测试，其底层基于 Google uiautomator，Google 提供的 uiautomator 库可以获取屏幕上任意一个 APP 的任意一个控件属性，并对其进行任意操作python-uiautomator2 封装了谷歌自带的 uiautomator2 测试框架，提供便利的 python 接口。他允许测试">
<meta name="keywords" content="iOS,Android,python">
<meta property="og:type" content="article">
<meta property="og:title" content="UIAutomator2的使用">
<meta property="og:url" content="https://ailab-aida.github.io/2019/09/29/UIAutomator2的使用/index.html">
<meta property="og:site_name" content="AILab-aida">
<meta property="og:description" content="uiautomator2 是一个 python 库，用于 Android 的 UI 自动化测试，其底层基于 Google uiautomator，Google 提供的 uiautomator 库可以获取屏幕上任意一个 APP 的任意一个控件属性，并对其进行任意操作python-uiautomator2 封装了谷歌自带的 uiautomator2 测试框架，提供便利的 python 接口。他允许测试">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png">
<meta property="og:image" content="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor.jpeg">
<meta property="og:image" content="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor_connect.png">
<meta property="og:image" content="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor_state.png">
<meta property="og:updated_time" content="2019-10-12T05:27:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UIAutomator2的使用">
<meta name="twitter:description" content="uiautomator2 是一个 python 库，用于 Android 的 UI 自动化测试，其底层基于 Google uiautomator，Google 提供的 uiautomator 库可以获取屏幕上任意一个 APP 的任意一个控件属性，并对其进行任意操作python-uiautomator2 封装了谷歌自带的 uiautomator2 测试框架，提供便利的 python 接口。他允许测试">
<meta name="twitter:image" content="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png">
  <link rel="canonical" href="https://ailab-aida.github.io/2019/09/29/UIAutomator2的使用/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>UIAutomator2的使用 | AILab-aida</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AILab-aida</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">一个专注技术的组织</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-sitemap">
      
    

    <a href="/atom.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/qq1074123922" class="github-corner" title="AILab-aida GitHub" aria-label="AILab-aida GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://ailab-aida.github.io/2019/09/29/UIAutomator2的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="AILab-aida">
      <meta itemprop="description" content="涉猎的主要编程语言为 深度学习、机器学习、大数据、服务端、移动端、前端、爬虫(go、scala、Java、flutter、Python、react、Vue)等。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AILab-aida">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">UIAutomator2的使用

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-09-29 13:59:37" itemprop="dateCreated datePublished" datetime="2019-09-29T13:59:37+08:00">2019-09-29</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-10-12 13:27:18" itemprop="dateModified" datetime="2019-10-12T13:27:18+08:00">2019-10-12</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/移动端/" itemprop="url" rel="index"><span itemprop="name">移动端</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>uiautomator2 是一个 python 库，用于 Android 的 UI 自动化测试，其底层基于 Google uiautomator，Google 提供的 uiautomator 库可以获取屏幕上任意一个 APP 的任意一个控件属性，并对其进行任意操作</p><p>python-uiautomator2 封装了谷歌自带的 uiautomator2 测试框架，提供便利的 python 接口。他允许测试人员直接在 PC 上编写 Python 的测试代码，操作手机应用，完成自动化，大大提高了自动化代码编写的效率。</p><a id="more"></a>

<p><img src="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86.png" alt><br>如图所示，python-uiautomator2 主要分为两个部分，python 客户端，移动设备</p>
<ul>
<li><p>python 端: 运行脚本，并向移动设备发送 HTTP 请求</p>
</li>
<li><p>移动设备：移动设备上运行了封装了 uiautomator2 的 HTTP 服务，解析收到的请求，并转化成 uiautomator2 的代码。</p>
</li>
</ul>
<p>整个过程</p>
<ol>
<li>在移动设备上安装 atx-agent(守护进程), 随后 atx-agent 启动 uiautomator2 服务 (默认 7912 端口) 进行监听</li>
<li>在 PC 上编写测试脚本并执行（相当于发送 HTTP 请求到移动设备的 server 端）</li>
<li>移动设备通过 WIFI 或 USB 接收到 PC 上发来的 HTTP 请求，执行制定的操作</li>
</ol>
<h2 id="安装-adb"><a href="#安装-adb" class="headerlink" title="安装 adb"></a><a href="#安装adb" title="安装adb"></a>安装 adb</h2><p>如命令行可以执行 adb devices，则跳过此步骤<br>从谷歌官网下载 Android Platform Tools <a href="https://developer.android.com/studio/releases/platform-tools.html%EF%BC%8C" target="_blank" rel="noopener">https://developer.android.com/studio/releases/platform-tools.html，</a> 解压，并加包含 adb.exe 的目录加入到系统的 PATH 中。</p>
<h2 id="安装-uiautomator2"><a href="#安装-uiautomator2" class="headerlink" title="安装 uiautomator2"></a><a href="#安装uiautomator2" title="安装uiautomator2"></a>安装 uiautomator2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade --pre uiautomator2</span><br></pre></td></tr></table></figure>
<h2 id="如果你需要用到截图，安装-pillow"><a href="#如果你需要用到截图，安装-pillow" class="headerlink" title="如果你需要用到截图，安装 pillow"></a><a href="#如果你需要用到截图，安装pillow" title="如果你需要用到截图，安装pillow"></a>如果你需要用到截图，安装 pillow</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow</span><br></pre></td></tr></table></figure>
<h2 id="设备安装-atx-agent"><a href="#设备安装-atx-agent" class="headerlink" title="设备安装 atx-agent"></a><a href="#设备安装atx-agent" title="设备安装atx-agent"></a>设备安装 atx-agent</h2><p>首先设备连接到 PC，并能够 adb devices 发现该设备。执行下面的命令会自动安装本库所需要的设备端程序：uiautomator-server，atx-agent，openstf / minicap，openstf / minitouch</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># init就是所有USB连接电脑的手机上都安装uiautomator2</span><br><span class="line">python -m uiautomator2 init</span><br><span class="line"></span><br><span class="line"># 指定手机安装uiautomator2， 用 --mirror</span><br><span class="line">python -m uiautomator2 init --mirror --serial $SERIAL</span><br><span class="line"></span><br><span class="line"># 嫌弃慢的话，可以用国内的镜像</span><br><span class="line">python -m uiautomator2 init --mirror</span><br></pre></td></tr></table></figure>
<p>最后提示 success，代表 atx-agent 初始化成功。</p>
<h2 id="安装-weditor"><a href="#安装-weditor" class="headerlink" title="安装 weditor"></a><a href="#安装weditor" title="安装weditor"></a>安装 weditor</h2><p>有了这个，方便我们快速的识别手机上的元素，方便写代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --pre -U weditor#pip install --pre weditor</span><br></pre></td></tr></table></figure>
<p>Windows 系统可以使用命令在桌面创建一个快捷方式 python -m weditor –shortcut</p>
<p>启动方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m weditor</span><br></pre></td></tr></table></figure>
<p>浏览器会自动打开一个网页 <a href="http://atx.open.netease.xn--com%2C-894fo3t2kodg8c3jdt70i/" target="_blank" rel="noopener">http://atx.open.netease.com，看到如下界面</a><br><img src="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor.jpeg" alt></p>
<p>重点说下这个部分<br><img src="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor_connect.png" alt><br>如何与手机连接起来呢？就是通过手机序列号或 IP 来实现的。打开 cmd, 输入 adb devices，查看手机序列号，输入框中填写设备的 IP 或者设备的 Serial（序列号）。之后点击 Connect，如果一切正常就会出现一个绿色的叶子<br><img src="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/weditor_state.png" alt><br>点击蓝色的 Reload，就可以在网页上看到手机的界面了。非常的强大。我们可以看到手机元素的各种定位方法，在 UI 自动化写代码的时候，真的是非常的方面，手机页面和 weditor 是实时同步的。</p>
<h2 id="【推荐】AppetizerIO-所见即所得脚本编辑器"><a href="#【推荐】AppetizerIO-所见即所得脚本编辑器" class="headerlink" title="【推荐】AppetizerIO 所见即所得脚本编辑器"></a><a href="#【推荐】AppetizerIO-所见即所得脚本编辑器" title="【推荐】AppetizerIO 所见即所得脚本编辑器"></a>【推荐】AppetizerIO 所见即所得脚本编辑器</h2><p><a href="https://www.appetizer.io/" target="_blank" rel="noopener">AppetizerIO</a> 提供了对 uiautomator2 的深度集成，可以图形化管理 ATX 设备，还有所见即所得脚本编辑器</p>
<ul>
<li>到网站下载直接打开，首次使用需要注册账号</li>
</ul>
<ul>
<li><code>设备管理</code> 界面里可以检查设备是否正常 init，起停 atx-agent，抓取 atx-agent.log 文件</li>
<li><code>APP测试-&gt;脚本助手</code>调出脚本助手，实时界面同步，点击界面直接插入各种代码，同时支持 uiautomator 和 Appium</li>
<li><strong><a href="https://github.com/openatx/uiautomator2/wiki/Appetizer%E6%89%80%E8%A7%81%E5%8D%B3%E6%89%80%E5%BE%97u2%E8%84%9A%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8" target="_blank" rel="noopener">视频教程 请戳这里</a></strong> <a href="http://doc.appetizer.io" target="_blank" rel="noopener">其他文档在此</a></li>
</ul>
<h2 id="调用-uiautomator2-的过程"><a href="#调用-uiautomator2-的过程" class="headerlink" title="调用 uiautomator2 的过程"></a><a href="#调用uiautomator2的过程" title="调用uiautomator2的过程"></a>调用 uiautomator2 的过程</h2><ol>
<li>配置手机设备参数，设置具体操作的是哪一台手机</li>
<li>抓取手机上应用的控件，制定对应的控件来进行操作</li>
<li>抓取手机上应用的控件，制定对应的控件来进行操作抓取手机上应用的控件，制定对应的控件来进行操作<br>对抓取到的控件进行操作，比如点击、填写参数等。</li>
</ol>
<h2 id="设备连接方法，有两种"><a href="#设备连接方法，有两种" class="headerlink" title="设备连接方法，有两种"></a><a href="#设备连接方法，有两种" title="设备连接方法，有两种"></a>设备连接方法，有两种</h2><p>python-uiautomator2 连接手机的方式有两种，一种是通过 WIFI，另外一种是通过 USB。两种方法各有优缺点。<br>WIFI 最便利的地方要数可以不用连接数据线，USB 则可以用在 PC 和手机网络不在一个网段用不了的情况。</p>
<ol>
<li>通过 WiFi，假设设备 IP 192.168.5.4 和您的 PC 在同一网络中</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import uiautomator2 as u2</span><br><span class="line">d = u2.connect(&apos;192.168.5.4&apos;) # WIFI链接设备。或者u2.connect_wifi(&apos;10.0.0.1&apos;)</span><br></pre></td></tr></table></figure>
<ol>
<li>通过 USB， 假设设备序列是 123456789F（见 adb devices）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import uiautomator2 as u2</span><br><span class="line">d = u2.connect(&apos;123456789F&apos;) # USB链接设备。或者u2.connect_usb(&apos;123456f&apos;)</span><br><span class="line">#d = u2.connect_usb()#当前只有一个设备时可以用这个</span><br></pre></td></tr></table></figure>
<p>在没有参数的情况下调用 u2.connect()， uiautomator2 将从环境变量 ANDROID_DEVICE_IP 获取设备 IP。如果这个环境变量是空的，uiautomator 将返回 connect_usb，您需要确保只有一个设备连接到计算机。</p>
<h2 id="检查并维持设备端守护进程处于运行状态"><a href="#检查并维持设备端守护进程处于运行状态" class="headerlink" title="检查并维持设备端守护进程处于运行状态"></a><a href="#检查并维持设备端守护进程处于运行状态" title="检查并维持设备端守护进程处于运行状态"></a>检查并维持设备端守护进程处于运行状态</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.healthcheck()</span><br></pre></td></tr></table></figure>
<h2 id="停用-UiAutomator-的守护程序"><a href="#停用-UiAutomator-的守护程序" class="headerlink" title="停用 UiAutomator 的守护程序?"></a><a href="#停用UiAutomator的守护程序" title="停用UiAutomator的守护程序?"></a>停用 UiAutomator 的守护程序?</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.service(&apos;uiautomator&apos;).stop()</span><br></pre></td></tr></table></figure>
<h2 id="打开调试开关"><a href="#打开调试开关" class="headerlink" title="打开调试开关"></a><a href="#打开调试开关" title="打开调试开关"></a>打开调试开关</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d.debug = True</span><br><span class="line">d.info</span><br><span class="line"></span><br><span class="line">返回</span><br><span class="line">12:32:47.182 $ curl -X POST -d &apos;&#123;&quot;jsonrpc&quot;: &quot;2.0&quot;, &quot;id&quot;: &quot;b80d3a488580be1f3e9cb3e926175310&quot;, &quot;method&quot;: &quot;deviceInfo&quot;, &quot;params&quot;: &#123;&#125;&#125;&apos; &apos;http://127.0.0.1:54179/jsonrpc/0&apos;</span><br><span class="line">12:32:47.225 Response &gt;&gt;&gt;</span><br><span class="line">&#123;&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:&quot;b80d3a488580be1f3e9cb3e926175310&quot;,&quot;result&quot;:&#123;&quot;currentPackageName&quot;:&quot;com.android.mms&quot;,&quot;displayHeight&quot;:1920,&quot;displayRotation&quot;:0,&quot;displaySizeDpX&quot;:360,&quot;displaySizeDpY&quot;:640,&quot;displayWidth&quot;:1080,&quot;productName&quot;</span><br><span class="line">:&quot;odin&quot;,&quot;screenOn&quot;:true,&quot;sdkInt&quot;:25,&quot;naturalOrientation&quot;:true&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="安装应用，只能从-URL-安装"><a href="#安装应用，只能从-URL-安装" class="headerlink" title="安装应用，只能从 URL 安装"></a><a href="#安装应用，只能从 URL 安装" title="安装应用，只能从 URL 安装"></a>安装应用，只能从 URL 安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.app_install(&apos;http://some-domain.com/some.apk&apos;)#引号内为下载apk地址</span><br></pre></td></tr></table></figure>
<h2 id="启动应用"><a href="#启动应用" class="headerlink" title="启动应用"></a><a href="#启动应用" title="启动应用"></a>启动应用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.app_start(&apos;com.ruguoapp.jike&apos;)#引号内为包名称</span><br></pre></td></tr></table></figure>
<h2 id="停止应用"><a href="#停止应用" class="headerlink" title="停止应用"></a><a href="#停止应用" title="停止应用"></a>停止应用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#相当于&apos;am force-stop&apos;强制停止应用</span><br><span class="line">d.app_stop(&apos;com.example.hello_world&apos;)</span><br><span class="line">#相当于&apos;pm clear&apos; 清空App数据</span><br><span class="line">d.app_clear(&apos;com.example.hello_world&apos;)</span><br></pre></td></tr></table></figure>
<h2 id="停止所有正在运行的应用程序"><a href="#停止所有正在运行的应用程序" class="headerlink" title="停止所有正在运行的应用程序"></a><a href="#停止所有正在运行的应用程序" title="停止所有正在运行的应用程序"></a>停止所有正在运行的应用程序</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 停止所有</span><br><span class="line">d.app_stop_all()</span><br><span class="line"># 停止所有应用程序，除了com.examples.demo</span><br><span class="line">d.app_stop_all(excludes=[&apos;com.examples.demo&apos;])</span><br></pre></td></tr></table></figure>
<h2 id="跳过弹窗，禁止弹窗"><a href="#跳过弹窗，禁止弹窗" class="headerlink" title="跳过弹窗，禁止弹窗"></a><a href="#跳过弹窗，禁止弹窗" title="跳过弹窗，禁止弹窗"></a>跳过弹窗，禁止弹窗</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.disable_popups（）#自动跳过弹出窗口</span><br><span class="line">d.disable_popups（假）#禁用自动跳过弹出窗</span><br></pre></td></tr></table></figure>
<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a><a href="#Session" title="Session"></a>Session</h2><p>Session 表示应用程序的生命周期。可用于启动应用，检测应用崩溃</p>
<ul>
<li>启动和关闭应用程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sess = d.session(&quot;com.netease.cloudmusic&quot;) # start 网易云音乐</span><br><span class="line">sess.close() # 停止网易云音乐</span><br></pre></td></tr></table></figure>
<ul>
<li>使用 python with 启动和关闭应用程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">with d.session(&quot;com.netease.cloudmusic&quot;) as sess:</span><br><span class="line">sess(text=&quot;Play&quot;).click()</span><br></pre></td></tr></table></figure>
<ul>
<li>链接正在运行的应用</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sess = d.session（“ com.netease.cloudmusic ”，attach = True）</span><br></pre></td></tr></table></figure>
<ul>
<li>检测应用崩溃</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># App 正在运行时</span><br><span class="line"></span><br><span class="line">sess(text=&quot;Music&quot;).click() # 操作是正常的</span><br><span class="line"></span><br><span class="line"># App 崩溃时</span><br><span class="line"></span><br><span class="line">sess(text=&quot;Music&quot;).click() # 引发会话中断错误 SessionBrokenError</span><br><span class="line"></span><br><span class="line"># session 下的其他函数调用也会引发 SessionBrokenError 错误</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 检查会话是否正确。</span><br><span class="line"></span><br><span class="line"># 警告:函数名将来可能会更改</span><br><span class="line"></span><br><span class="line">sess.running() # True or False</span><br></pre></td></tr></table></figure>
<h2 id="获取设备信息"><a href="#获取设备信息" class="headerlink" title="获取设备信息"></a><a href="#获取设备信息" title="获取设备信息"></a>获取设备信息</h2><ul>
<li>获取基本信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.info</span><br></pre></td></tr></table></figure>
<p>以下是可能的输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">u&apos;displayRotation&apos;: 0,</span><br><span class="line">u&apos;displaySizeDpY&apos;: 640,</span><br><span class="line">u&apos;displaySizeDpX&apos;: 360,</span><br><span class="line">u&apos;currentPackageName&apos;: u&apos;com.android.launcher&apos;,</span><br><span class="line">u&apos;productName&apos;: u&apos;takju&apos;,</span><br><span class="line">u&apos;displayWidth&apos;: 720,</span><br><span class="line">u&apos;sdkInt&apos;: 18,</span><br><span class="line">u&apos;displayHeight&apos;: 1184,</span><br><span class="line">u&apos;naturalOrientation&apos;: True</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取窗口大小</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d.window_size()</span><br><span class="line"></span><br><span class="line"># 设备垂直输出示例: (1080, 1920)</span><br><span class="line"></span><br><span class="line"># 设备水平输出示例: (1920, 1080)</span><br></pre></td></tr></table></figure>
<ul>
<li>获取当前应用程序信息。对于某些 android 设备，输出可以为空 (参见输出示例 3)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d.current_app()</span><br><span class="line"></span><br><span class="line"># 输出示例 1: &#123;&apos;package&apos;: &apos;com.netease.example&apos;, &apos;activity&apos;: &apos;.Client&apos;, &apos;pid&apos;: 23710&#125;</span><br><span class="line"></span><br><span class="line"># 输出示例 2: &#123;&apos;package&apos;: &apos;com.ruguoapp.jike&apos;, &apos;activity&apos;: &apos;com.ruguoapp.jike.business.video.ui.activity.videolist.VideoListActivity&apos;&#125;</span><br><span class="line"></span><br><span class="line"># 输出示例 3: &#123;&apos;package&apos;: None, &apos;activity&apos;: None&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取设备序列号</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d.serial</span><br><span class="line"></span><br><span class="line"># 输出示例: 74aAEDR428Z9</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 WIFI IP</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(d.wlan_ip) #输出示例:10.0.0.1</span><br></pre></td></tr></table></figure>
<ul>
<li>获取详细的设备信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(d.device_info)</span><br></pre></td></tr></table></figure>
<p>下面是一个可能的输出:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;udid&apos;: &apos;3578298f-b4:0b:44:e6:1f:90-OD103&apos;,</span><br><span class="line">&apos;version&apos;: &apos;7.1.1&apos;,</span><br><span class="line">&apos;serial&apos;: &apos;3578298f&apos;,</span><br><span class="line">&apos;brand&apos;: &apos;SMARTISAN&apos;,</span><br><span class="line">&apos;model&apos;: &apos;OD103&apos;,</span><br><span class="line">&apos;hwaddr&apos;: &apos;b4:0b:44:e6:1f:90&apos;,</span><br><span class="line">&apos;port&apos;: 7912,</span><br><span class="line">&apos;sdk&apos;: 25,</span><br><span class="line">&apos;agentVersion&apos;: &apos;dev&apos;,</span><br><span class="line">&apos;display&apos;: &#123;&apos;width&apos;: 1080, &apos;height&apos;: 1920&#125;,</span><br><span class="line">&apos;battery&apos;: &#123;&apos;acPowered&apos;: False,</span><br><span class="line">&apos;usbPowered&apos;: False,</span><br><span class="line">&apos;wirelessPowered&apos;: False,</span><br><span class="line">&apos;status&apos;: 3,</span><br><span class="line">&apos;health&apos;: 0,</span><br><span class="line">&apos;present&apos;: True,</span><br><span class="line">&apos;level&apos;: 99,</span><br><span class="line">&apos;scale&apos;: 100,</span><br><span class="line">&apos;voltage&apos;: 4316,</span><br><span class="line">&apos;temperature&apos;: 272,</span><br><span class="line">&apos;technology&apos;: &apos;Li-ion&apos;&#125;,</span><br><span class="line">&apos;memory&apos;: &#123;&apos;total&apos;: 3690280, &apos;around&apos;: &apos;4 GB&apos;&#125;,</span><br><span class="line">&apos;cpu&apos;: &#123;&apos;cores&apos;: 8, &apos;hardware&apos;: &apos;Qualcomm Technologies, Inc MSM8953Pro&apos;&#125;,</span><br><span class="line">&apos;presenceChangedAt&apos;: &apos;0001-01-01T00:00:00Z&apos;,</span><br><span class="line">&apos;usingBeganAt&apos;: &apos;0001-01-01T00:00:00Z&apos;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="获取应用信息"><a href="#获取应用信息" class="headerlink" title="获取应用信息"></a><a href="#获取应用信息" title="获取应用信息"></a>获取应用信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">d.app_info(&quot;com.examples.demo&quot;)</span><br><span class="line"></span><br><span class="line"># 会输出</span><br><span class="line"></span><br><span class="line">#&#123;</span><br><span class="line"></span><br><span class="line"># &quot;mainActivity&quot;: &quot;com.github.uiautomator.MainActivity&quot;,</span><br><span class="line"></span><br><span class="line"># &quot;label&quot;: &quot;ATX&quot;,</span><br><span class="line"></span><br><span class="line"># &quot;versionName&quot;: &quot;1.1.7&quot;,</span><br><span class="line"></span><br><span class="line"># &quot;versionCode&quot;: 1001007,</span><br><span class="line"></span><br><span class="line"># &quot;size&quot;:1760809</span><br><span class="line"></span><br><span class="line">#&#125;</span><br><span class="line"></span><br><span class="line"># 保存应用程序图标</span><br><span class="line"></span><br><span class="line">img = d.app_icon(&quot;com.examples.demo&quot;)</span><br><span class="line">img.save(&quot;icon.png&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="推拉文件"><a href="#推拉文件" class="headerlink" title="推拉文件"></a><a href="#推拉文件" title="推拉文件"></a>推拉文件</h2><ul>
<li>将文件推送到设备</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># push 文件夹</span><br><span class="line"></span><br><span class="line">d.push(&quot;foo.txt&quot;, &quot;/sdcard/&quot;)</span><br><span class="line"></span><br><span class="line"># push 和重命名</span><br><span class="line"></span><br><span class="line">d.push(&quot;foo.txt&quot;, &quot;/sdcard/bar.txt&quot;)</span><br><span class="line"></span><br><span class="line"># push fileobj</span><br><span class="line"></span><br><span class="line">with open(&quot;foo.txt&quot;, &apos;rb&apos;) as f:</span><br><span class="line">d.push(f, &quot;/sdcard/&quot;)</span><br><span class="line"></span><br><span class="line"># 推动和更改文件访问模式</span><br><span class="line"></span><br><span class="line">d.push(&quot;foo.sh&quot;, &quot;/data/local/tmp/&quot;, mode=0o755)</span><br></pre></td></tr></table></figure>
<ul>
<li>从设备中拉出一个文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">d.pull(&quot;/sdcard/tmp.txt&quot;, &quot;tmp.txt&quot;)</span><br><span class="line"></span><br><span class="line"># 如果在设备上找不到文件，FileNotFoundError 将引发</span><br><span class="line"></span><br><span class="line">d.pull(&quot;/sdcard/some-file-not-exists.txt&quot;, &quot;tmp.txt&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="关键事件"><a href="#关键事件" class="headerlink" title="关键事件"></a><a href="#关键事件" title="关键事件"></a>关键事件</h2><ul>
<li>打开 / 关闭屏幕</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.screen_on（）＃打开屏幕</span><br><span class="line">d.screen_off（）＃关闭屏幕</span><br></pre></td></tr></table></figure>
<ul>
<li>获取当前屏幕状态</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.info.get（&apos; screenOn &apos;）#需要 Android&gt; = 4.4</span><br></pre></td></tr></table></figure>
<ul>
<li>硬键盘和软键盘操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">d.press(&quot;home&quot;) # 点击 home 键</span><br><span class="line">d.press(&quot;back&quot;) # 点击 back 键</span><br><span class="line">d.press(&quot;left&quot;) # 点击左键</span><br><span class="line">d.press(&quot;right&quot;) # 点击右键</span><br><span class="line">d.press(&quot;up&quot;) # 点击上键</span><br><span class="line">d.press(&quot;down&quot;) # 点击下键</span><br><span class="line">d.press(&quot;center&quot;) # 点击选中</span><br><span class="line">d.press(&quot;menu&quot;) # 点击 menu 按键</span><br><span class="line">d.press(&quot;search&quot;) # 点击搜索按键</span><br><span class="line">d.press(&quot;enter&quot;) # 点击 enter 键</span><br><span class="line">d.press(&quot;delete&quot;) # 点击删除按键</span><br><span class="line">d.press(&quot;recent&quot;) # 点击近期活动按键</span><br><span class="line">d.press(&quot;volume_up&quot;) # 音量+</span><br><span class="line">d.press(&quot;volume_down&quot;) # 音量-</span><br><span class="line">d.press(&quot;volume_mute&quot;) # 静音</span><br><span class="line">d.press(&quot;camera&quot;) # 相机</span><br><span class="line">d.press(&quot;power&quot;) #电源键</span><br></pre></td></tr></table></figure>
<p>你可以在 <a href="https://developer.android.com/reference/android/view/KeyEvent.html" target="_blank" rel="noopener">Android KeyEvnet</a> 上找到所有的关键代码定义</p>
<ul>
<li>解锁屏幕</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d.unlock()</span><br><span class="line"></span><br><span class="line"># 相当于</span><br><span class="line"></span><br><span class="line"># 1. 发射活动:com.github.uiautomator.ACTION_IDENTIFY</span><br><span class="line"></span><br><span class="line"># 2. 按 home 键</span><br></pre></td></tr></table></figure>
<h2 id="手势与设备的交互"><a href="#手势与设备的交互" class="headerlink" title="手势与设备的交互"></a><a href="#手势与设备的交互" title="手势与设备的交互"></a>手势与设备的交互</h2><ul>
<li>单击屏幕</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.click（x，y）</span><br></pre></td></tr></table></figure>
<ul>
<li>双击屏幕</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.double_click（x，y）</span><br><span class="line">d.double_click（X，Y，0.1）＃默认两个单击之间间隔时间为 0.1 秒</span><br></pre></td></tr></table></figure>
<ul>
<li>长按</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.long_click（x，y）</span><br><span class="line">d.long_click（X，Y，0.5）#长按 0.5 秒（默认）</span><br></pre></td></tr></table></figure>
<ul>
<li>滑动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.swipe(sx, sy, ex, ey)</span><br><span class="line">d.swipe(sx, sy, ex, ey, 0.5) #滑动 0.5s(default)</span><br></pre></td></tr></table></figure>
<ul>
<li>拖动</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.drag(sx, sy, ex, ey)</span><br><span class="line">d.drag(sx, sy, ex, ey, 0.5)#拖动 0.5s(default)</span><br></pre></td></tr></table></figure>
<ul>
<li>滑动点 多用于九宫格解锁，提前获取到每个点的相对坐标（这里支持百分比），<br>更详细的使用参考这个帖子 <a href="https://testerhome.com/topics/11034" target="_blank" rel="noopener">使用 u2 实现九宫图案解锁</a></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#从点(x0, y0)滑到点(x1, y1)再滑到点(x2, y2) #两点之间的滑动速度是 0.2 秒</span><br><span class="line">d.swipe((x0, y0), (x1, y1), (x2, y2), 0.2)</span><br></pre></td></tr></table></figure>
<p>注意：单击，滑动，拖动操作支持百分比位置值。例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.long_click(0.5, 0.5) 表示长按屏幕中心</span><br></pre></td></tr></table></figure>
<h2 id="屏幕相关的"><a href="#屏幕相关的" class="headerlink" title="屏幕相关的"></a><a href="#屏幕相关的" title="屏幕相关的"></a>屏幕相关的</h2><ul>
<li>检索方向</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d.orientation</span><br><span class="line"></span><br><span class="line"># 检索方向。输出可以是 &quot;natural&quot; or &quot;left&quot; or &quot;right&quot; or &quot;upsidedown&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>设置方向</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d.set_orientation(&apos;l&apos;) # or &quot;left&quot;</span><br><span class="line">d.set_orientation(&quot;l&quot;) # or &quot;left&quot;</span><br><span class="line">d.set_orientation(&quot;r&quot;) # or &quot;right&quot;</span><br><span class="line">d.set_orientation(&quot;n&quot;) # or &quot;natural&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>冻结 / 开启旋转</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.freeze_rotation()# 冻结旋转</span><br><span class="line">d.freeze_rotation(False)# 开启旋转</span><br></pre></td></tr></table></figure>
<ul>
<li>截图</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 截图并保存到电脑上的一个文件中，需要 Android&gt;=4.2。</span><br><span class="line"></span><br><span class="line">d.screenshot(&quot;home.jpg&quot;)</span><br><span class="line"></span><br><span class="line"># 得到 PIL.Image 格式的图像. 但你必须先安装 pillow</span><br><span class="line"></span><br><span class="line">image = d.screenshot() # default format=&quot;pillow&quot;</span><br><span class="line">image.save(&quot;home.jpg&quot;) # 或&apos;home.png&apos;，目前只支持 png 和 jpg 格式的图像</span><br><span class="line"></span><br><span class="line"># 得到 OpenCV 的格式图像。当然，你需要 numpy 和 cv2 安装第一个</span><br><span class="line"></span><br><span class="line">import cv2</span><br><span class="line">image = d.screenshot(format=&apos;opencv&apos;)</span><br><span class="line">cv2.imwrite(&apos;home.jpg&apos;, image)</span><br><span class="line"></span><br><span class="line"># 获取原始 JPEG 数据</span><br><span class="line"></span><br><span class="line">imagebin = d.screenshot(format=&apos;raw&apos;)</span><br><span class="line">open(&quot;some.jpg&quot;, &quot;wb&quot;).write(imagebin)</span><br></pre></td></tr></table></figure>
<ul>
<li>转储 UI 层次结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># get the UI hierarchy dump content (unicoded).（获取 UI 层次结构转储内容）</span><br><span class="line"></span><br><span class="line">d.dump_hierarchy()</span><br></pre></td></tr></table></figure>
<ul>
<li>打开通知或快速设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.open_notification（）#下拉打开通知栏</span><br><span class="line">d.open_quick_settings（）#下拉打开快速设置栏</span><br></pre></td></tr></table></figure>
<h2 id="选择-Ui-对象"><a href="#选择-Ui-对象" class="headerlink" title="选择 Ui 对象"></a><a href="#选择Ui对象" title="选择Ui对象"></a>选择 Ui 对象</h2><p>选择器是一种方便的机制，用于在当前窗口中标识特定的 UI 对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#选择带有文本&apos;Clock&apos;的对象，它的类名是&apos;android.widget.TextView&apos;</span><br><span class="line">d(text=&apos;Clock&apos;, className=&apos;android.widget.TextView&apos;)</span><br></pre></td></tr></table></figure>
<p>选择器支持以下参数。有关详细信息，请参阅 <a href="http://developer.android.com/tools/help/uiautomator/UiSelector.html" target="_blank" rel="noopener">UiSelector Java doc</a> for detailed information.</p>
<ul>
<li><code>text</code>, <code>textContains</code>, <code>textMatches</code>, <code>textStartsWith</code></li>
<li><code>className</code>, <code>classNameMatches</code></li>
<li><code>description</code>, <code>descriptionContains</code>, <code>descriptionMatches</code>, <code>descriptionStartsWith</code></li>
<li><code>checkable</code>, <code>checked</code>, <code>clickable</code>, <code>longClickable</code></li>
<li><code>scrollable</code>, <code>enabled</code>,<code>focusable</code>, <code>focused</code>, <code>selected</code></li>
<li><code>packageName</code>, <code>packageNameMatches</code></li>
<li><code>resourceId</code>, <code>resourceIdMatches</code></li>
<li><code>index</code>, <code>instance</code></li>
</ul>
<h2 id="获取所选-ui-对象状态及其信息"><a href="#获取所选-ui-对象状态及其信息" class="headerlink" title="获取所选 ui 对象状态及其信息"></a>获取所选 ui 对象状态及其信息</h2><ul>
<li>检查特定的 UI 对象是否存在</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).exists # 返回布尔值，如果存在则为 True，否则为 False</span><br><span class="line">d.exists(text=&quot;Settings&quot;) # 另一种写法 #高级用法</span><br><span class="line">d(text=&quot;Settings&quot;).exists(timeout=3) # 等待&apos;Settings&apos;在 3 秒钟出现</span><br></pre></td></tr></table></figure>
<ul>
<li>获取特定 UI 对象的信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).info</span><br></pre></td></tr></table></figure>
<p>下面是一个可能的输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&apos;bounds&apos;: &#123;</span><br><span class="line">&apos;bottom&apos;: 2744,</span><br><span class="line">&apos;left&apos;: 386,</span><br><span class="line">&apos;right&apos;: 478,</span><br><span class="line">&apos;top&apos;: 2679&#125;,</span><br><span class="line">&apos;childCount&apos;: 0,</span><br><span class="line">&apos;className&apos;: &apos;android.widget.TextView&apos;,</span><br><span class="line">&apos;contentDescription&apos;: None,</span><br><span class="line">&apos;packageName&apos;: &apos;com.ruguoapp.jike&apos;,</span><br><span class="line">&apos;resourceName&apos;: &apos;com.ruguoapp.jike:id/tv_main_tab_title&apos;,</span><br><span class="line">&apos;text&apos;: &apos;动态&apos;,</span><br><span class="line">&apos;visibleBounds&apos;: &#123;</span><br><span class="line">&apos;bottom&apos;: 2744,</span><br><span class="line">&apos;left&apos;: 386,</span><br><span class="line">&apos;right&apos;: 478,</span><br><span class="line">&apos;top&apos;: 2679&#125;,</span><br><span class="line">&apos;checkable&apos;: False,</span><br><span class="line">&apos;checked&apos;: False,</span><br><span class="line">&apos;clickable&apos;: False,</span><br><span class="line">&apos;enabled&apos;: True,</span><br><span class="line">&apos;focusable&apos;: False,</span><br><span class="line">&apos;focused&apos;: False,</span><br><span class="line">&apos;longClickable&apos;: False,</span><br><span class="line">&apos;scrollable&apos;: False,</span><br><span class="line">&apos;selected&apos;: False</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 / 设置 / 清除可编辑字段的文本 (例如 EditText 小部件)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).get_text() #得到文本小部件</span><br><span class="line">d(text=&quot;Settings&quot;).set_text(&quot;My text...&quot;) #设置文本</span><br><span class="line">d(text=&quot;Settings&quot;).clear_text() #清除文本</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 Widget 中心点</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).center()</span><br><span class="line">#d(text=&quot;Settings&quot;).center(offset=(0, 0)) # 基准位置左前</span><br></pre></td></tr></table></figure>
<h2 id="对选定-UI-对象的操作"><a href="#对选定-UI-对象的操作" class="headerlink" title="对选定 UI 对象的操作"></a><a href="#对选定UI对象的操作" title="对选定UI对象的操作"></a>对选定 UI 对象的操作</h2><ul>
<li><p>UI 对象有五种定位方式<br>text、resourceId、description、className、xpath、坐标</p>
</li>
<li><p>执行单击 UI 对象</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#text 定位单击</span><br><span class="line">d(text=&quot;Settings&quot;).click()</span><br><span class="line">d(text=&quot;Settings&quot;, class).click()</span><br><span class="line">#resourceId 定位单击</span><br><span class="line">d(resourceId=&quot;com.ruguoapp.jike:id/tv_title&quot;, class).click()</span><br><span class="line">#description 定位单击</span><br><span class="line">d(description=&quot;设置&quot;).click()</span><br><span class="line">d(description=&quot;设置&quot;, class).click()</span><br><span class="line">#className 定位单击</span><br><span class="line">d(class).click()</span><br><span class="line">#xpath 定位单击</span><br><span class="line">d.xpath(&quot;//android.widget.FrameLayout[@index=&apos;0&apos;]/android.widget.LinearLayout[@index=&apos;0&apos;]&quot;).click() #坐标单击</span><br><span class="line">d.click(182, 1264)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 等待元素出现(最多 10 秒），出现后单击</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).click(timeout=10)</span><br><span class="line"></span><br><span class="line"># 在 10 秒时点击，默认的超时 0</span><br><span class="line"></span><br><span class="line">d(text=&apos;Skip&apos;).click_exists(timeout=10.0)</span><br><span class="line"></span><br><span class="line"># 单击直到元素消失，返回布尔</span><br><span class="line"></span><br><span class="line">d(text=&quot;Skip&quot;).click_gone(maxretry=10, interval=1.0) # maxretry 默认值 10,interval 默认值 1.0</span><br><span class="line"></span><br><span class="line"># 点击基准位置偏移</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).click(offset=(0.5, 0.5)) # 点击中心位置，同 d(text=&quot;Settings&quot;).click()</span><br><span class="line">d(text=&quot;Settings&quot;).click(offset=(0, 0)) # 点击左前位置</span><br><span class="line">d(text=&quot;Settings&quot;).click(offset=(1, 1)) # 点击右下</span><br></pre></td></tr></table></figure>
<ul>
<li>执行双击 UI 对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;设置&quot;).double_click() #双击特定 ui 对象的中心</span><br><span class="line">d.double_click(x, y, 0.1)#两次单击之间的默认持续时间为 0.1 秒</span><br></pre></td></tr></table></figure>
<ul>
<li>执行长按 UI 对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 长按特定 UI 对象的中心</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).long_click()</span><br><span class="line">d.long_click(x, y, 0.5) # 长按坐标位置 0.5s 默认</span><br></pre></td></tr></table></figure>
<h2 id="特定-UI-对象的手势操作"><a href="#特定-UI-对象的手势操作" class="headerlink" title="特定 UI 对象的手势操作"></a>特定 UI 对象的手势操作</h2><ul>
<li>将 UI 对象拖向另一个点或另一个 UI 对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Android&lt;4.3 不能使用 drag.</span><br><span class="line"></span><br><span class="line"># 在 0.5 秒内将 UI 对象拖到屏幕点(x, y)</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).drag_to(x, y, duration=0.5)</span><br><span class="line"></span><br><span class="line"># 将 UI 对象拖到另一个 UI 对象的中心位置，时间为 0.25 秒</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).drag_to(text=&quot;Clock&quot;, duration=0.25)</span><br></pre></td></tr></table></figure>
<ul>
<li>从 UI 对象的中心向其边缘滑动<br>滑动支持 4 个方向: 左、右、上、下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).swipe(&quot;right&quot;)</span><br><span class="line">d(text=&quot;Settings&quot;).swipe(&quot;left&quot;, steps=10)</span><br><span class="line">d(text=&quot;Settings&quot;).swipe(&quot;up&quot;, steps=20) # 1步约为5ms, 20步约为0.1s</span><br><span class="line">d(text=&quot;Settings&quot;).swipe(&quot;down&quot;, steps=20)</span><br></pre></td></tr></table></figure>
<ul>
<li>两点手势操作，从一个点到另一个点</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d(text=&quot;Settings&quot;).gesture((sx1, sy1), (sx2, sy2), (ex1, ey1), (ex2, ey2))</span><br></pre></td></tr></table></figure>
<ul>
<li>特定 UI 对象的手势操作<br>支持两种手势：从边缘到中心、从中心到边缘</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#注意:缩放要到安卓 4.3 才能设置。 #从边缘到中心</span><br><span class="line">d(text=&quot;Settings&quot;).pinch_in(percent=100, steps=10)</span><br><span class="line"># 从中心到边缘</span><br><span class="line">d(text=&quot;Settings&quot;).pinch_out()</span><br></pre></td></tr></table></figure>
<ul>
<li>等待，直到特定的 UI 出现或消失</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 等待 ui 对象出现</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).wait(timeout=3.0) # 返回布尔值</span><br><span class="line"></span><br><span class="line"># 等待 ui 对象的消失</span><br><span class="line"></span><br><span class="line">d(text=&quot;Settings&quot;).wait_gone(timeout=1.0)</span><br></pre></td></tr></table></figure>
<p>默认超时为 20 秒。有关详细信息，请参阅全局设置</p>
<ul>
<li>对特定的 ui 对象执行投掷 (可滚动)<br>可能的属性</li>
</ul>
<ol>
<li><code>horiz</code>（水平） 或 <code>vert</code>（垂直）</li>
<li><code>forward</code>（向前）或<code>backward</code>（向后）或<code>toBeginning</code>（开始位置）或<code>toEnd</code>（结束位置）</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#向前投掷(默认)垂直(默认)</span><br><span class="line">d(scrollable=True).fling()</span><br><span class="line">#垂直向后滚动</span><br><span class="line">d(scrollable=True).fling.vert.forward()</span><br><span class="line">#没搞懂</span><br><span class="line">d(scrollable=True).fling.vert.backward()</span><br><span class="line">#没搞懂</span><br><span class="line">d(scrollable=True).fling.horiz.toBeginning(max_swipes=1000)</span><br><span class="line">#滚动到结束</span><br><span class="line">d(scrollable=True).fling.toEnd()</span><br></pre></td></tr></table></figure>
<ul>
<li>在特定的 ui 对象上执行滚动 (可滚动)<br>可能的属性</li>
</ul>
<ol>
<li><code>horiz</code>（水平） 或 <code>vert</code>（垂直）</li>
<li><code>forward</code>（向前）或<code>backward</code>（向后）或<code>toBeginning</code>（开始位置）或<code>toEnd</code>（结束位置）或 <code>to</code> 来</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#向前滚动(默认)垂直(默认)</span><br><span class="line">d(scrollable=True).scroll(steps=10)</span><br><span class="line">#水平向前滚动</span><br><span class="line">d(scrollable=True).scroll.horiz.forward(steps=100)</span><br><span class="line">#垂直向后滚动</span><br><span class="line">d(scrollable=True).scroll.vert.backward()</span><br><span class="line">#滚动到开始水平</span><br><span class="line">d(scrollable=True).scroll.horiz.toBeginning(steps=100, max_swipes=1000)</span><br><span class="line">#滚动垂直结束</span><br><span class="line">d(scrollable=True).scroll.toEnd()</span><br><span class="line">#垂直向前滚动，直到出现特定的ui对象</span><br><span class="line">d(scrol)</span><br></pre></td></tr></table></figure>
<ul>
<li>Watcher（-未懂-</li>
</ul>
<p>当选择器没有找到匹配项时，可以注册 <a href="http://developer.android.com/tools/help/uiautomator/UiWatcher.html" target="_blank" rel="noopener">watchers</a> 来执行一些操作。</p>
<ul>
<li>注册 Watcher</li>
</ul>
<p>当选择器找不到匹配项时，uiautomator2 将运行所有注册的 watchers.<br>当条件匹配时单击目标</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d.watcher(&quot;AUTO_FC_WHEN_ANR&quot;).when(text=&quot;ANR&quot;).when(text=&quot;Wait&quot;) \</span><br><span class="line"> .click(text=&quot;Force Close&quot;)</span><br><span class="line"></span><br><span class="line"># d.watcher(name) ## 创建一个新的名为 watcher 的程序。</span><br><span class="line"></span><br><span class="line"># .when(condition) ## 监视程序的用户选择条件。</span><br><span class="line"></span><br><span class="line"># .click(target) ## 对目标 UiSelector 执行单击操作</span><br></pre></td></tr></table></figure>
<ul>
<li>还有一个关于点击的技巧。您可以不带参数地使用 click。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d.watcher(&quot;ALERT&quot;).when(text=&quot;OK&quot;).click()</span><br><span class="line"></span><br><span class="line"># 一样</span><br><span class="line"></span><br><span class="line">d.watcher(&quot;ALERT&quot;).when(text=&quot;OK&quot;).click(text=&quot;OK&quot;)</span><br></pre></td></tr></table></figure>
<ul>
<li>当条件为真时按下键</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">d.watcher(&quot;AUTO_FC_WHEN_ANR&quot;).when(text=&quot;ANR&quot;).when(text=&quot;Wait&quot;) \</span><br><span class="line"> .press(&quot;back&quot;, &quot;home&quot;)</span><br><span class="line"></span><br><span class="line"># d.watcher(name) ## 创建一个新的名为 watcher 的程序</span><br><span class="line"></span><br><span class="line"># .when(condition) ## 监视程序的用户选择条件</span><br><span class="line"></span><br><span class="line"># .press(&lt;keyname&gt;, ..., &lt;keyname&gt;.() ## 按顺序按下一个键</span><br></pre></td></tr></table></figure>
<ul>
<li>检查指定的监视程序是否触发<br>一个监视程序被触发，这意味着运行了监视程序并匹配了它的所有条件。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d.watcher(&quot;watcher_name&quot;).triggered</span><br><span class="line"></span><br><span class="line"># 如果指定的监视程序被触发，则为 true，否则为 false</span><br></pre></td></tr></table></figure>
<ul>
<li>删除指定的监视程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 删除观察者</span><br><span class="line"></span><br><span class="line">d.watcher(&quot;watcher_name&quot;).remove()</span><br></pre></td></tr></table></figure>
<ul>
<li>列出所有观察者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d.watchers #列出所有注册观察员的名单</span><br></pre></td></tr></table></figure>
<ul>
<li>检查任何触发的监视程序</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d.watchers.triggered</span><br><span class="line"></span><br><span class="line"># 在任何监视程序触发时为真</span><br></pre></td></tr></table></figure>
<ul>
<li>重置所有触发观察者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 重置所有触发的观察者，然后是 d.观察者。触发将为 false。</span><br><span class="line"></span><br><span class="line">d.watchers.reset()</span><br></pre></td></tr></table></figure>
<ul>
<li>删除观察者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 删除所有注册观察者</span><br><span class="line"></span><br><span class="line">d.watchers.remove()</span><br><span class="line"></span><br><span class="line"># 删除指定的监视程序，与 d.watcher(“watcher_name”)相同。</span><br><span class="line"></span><br><span class="line">d.watchers.remove(&quot;watcher_name&quot;)</span><br></pre></td></tr></table></figure>
<ul>
<li>强制运行所有的观察者</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 强制运行所有注册的观察者</span><br><span class="line"></span><br><span class="line">d.watchers.run()</span><br></pre></td></tr></table></figure>
<ul>
<li>当页面更新时运行所有观察者。<br>通常可以用来自动点击权限确认框，或者自动安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">d.watcher(&quot;OK&quot;).when(text=&quot;OK&quot;).click(text=&quot;OK&quot;)</span><br><span class="line"></span><br><span class="line"># 启用自动触发监视程序</span><br><span class="line"></span><br><span class="line">d.watchers.watched = True</span><br><span class="line"></span><br><span class="line"># 禁用自动触发监视程序</span><br><span class="line"></span><br><span class="line">d.watchers.watched = False</span><br><span class="line"></span><br><span class="line"># 获取当前触发器监视者状态</span><br><span class="line"></span><br><span class="line">assert d.watchers.watched == False</span><br></pre></td></tr></table></figure>
<p>另外文档还是有很多没有写，推荐直接去看源码 <a href="https://vic.kim/2019/05/20/UIAutomator2%E7%9A%84%E4%BD%BF%E7%94%A8/uiautomator2/__init__.py" target="_blank" rel="noopener"><strong>init</strong>.py</a></p>
<h2 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a><a href="#全局设置" title="全局设置"></a>全局设置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 设置每次 UI 点击后 1.5 秒的延迟</span><br><span class="line"></span><br><span class="line">d.click_post_delay = 1.5 # 默认没有延迟</span><br><span class="line"></span><br><span class="line"># 设置默认元素等待超时(秒)</span><br><span class="line"></span><br><span class="line">d.wait_timeout = 30.0 # 默认的 20.0</span><br></pre></td></tr></table></figure>
<p>UiAutomator 中的超时设置 (隐藏方法)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt; &gt; d.jsonrpc.getConfigurator()</span><br><span class="line">&gt; &gt; &#123;&apos;actionAcknowledgmentTimeout&apos;: 500,</span><br><span class="line">&gt; &gt; &apos;keyInjectionDelay&apos;: 0,</span><br><span class="line">&gt; &gt; &apos;scrollAcknowledgmentTimeout&apos;: 200,</span><br><span class="line">&gt; &gt; &apos;waitForIdleTimeout&apos;: 0,</span><br><span class="line">&gt; &gt; &apos;waitForSelectorTimeout&apos;: 0&#125;</span><br><span class="line"></span><br><span class="line">&gt; &gt; d.jsonrpc.setConfigurator(&#123;&quot;waitForIdleTimeout&quot;: 100&#125;)</span><br><span class="line">&gt; &gt; &#123;&apos;actionAcknowledgmentTimeout&apos;: 500,</span><br><span class="line">&gt; &gt; &apos;keyInjectionDelay&apos;: 0,</span><br><span class="line">&gt; &gt; &apos;scrollAcknowledgmentTimeout&apos;: 200,</span><br><span class="line">&gt; &gt; &apos;waitForIdleTimeout&apos;: 100,</span><br><span class="line">&gt; &gt; &apos;waitForSelectorTimeout&apos;: 0&#125;</span><br></pre></td></tr></table></figure>
<p>为了防止客户端程序响应超时，<code>waitForIdleTimeout</code>和<code>waitForSelectorTimeout</code>目前已改为<code>0</code></p>
<p>Refs: <a href="https://developer.android.com/reference/android/support/test/uiautomator/Configurator" target="_blank" rel="noopener">Google uiautomator Configurator</a></p>
<h2 id="Input-method"><a href="#Input-method" class="headerlink" title="Input method"></a><a href="#Input-method" title="Input method"></a>Input method</h2><p>这种方法通常用于不知道控件的情况下的输入。第一步需要切换输入法，然后发送 adb 广播命令，具体使用方法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d.set_fastinput_ime(True) # 切换成 FastInputIME 输入法</span><br><span class="line">d.send_keys(&quot;你好 123abcEFG&quot;) # adb 广播输入</span><br><span class="line">d.clear_text() # 清除输入框所有内容(Require android-uiautomator.apk version &gt;= 1.0.7)</span><br><span class="line">d.set_fastinput_ime(False) # 切换成正常的输入法</span><br><span class="line">d.send_action(&quot;search&quot;) # 模拟输入法的搜索</span><br></pre></td></tr></table></figure>
<p><strong>send_action</strong> 说明</p>
<p>该函数可以使用的参数有 <code>go search send next done previous</code></p>
<p><em>什么时候该使用这个函数呢？</em></p>
<p>有些时候在 EditText 中输入完内容之后，调用<code>press(&quot;search&quot;)</code> or <code>press(&quot;enter&quot;)</code>发现并没有什么反应。<br>这个时候就需要<code>send_action</code>函数了，这里用到了只有输入法才能用的 <a href="https://developer.android.com/reference/android/view/inputmethod/EditorInfo" target="_blank" rel="noopener">IME_ACTION_CODE</a>。<br><code>send_action</code>先 broadcast 命令发送给输入法操作<code>IME_ACTION_CODE</code>，由输入法完成后续跟 EditText 的通信。（原理我不太清楚，有了解的，提 issue 告诉我)</p>
<h2 id="Toast"><a href="#Toast" class="headerlink" title="Toast"></a><a href="#Toast" title="Toast"></a>Toast</h2><ul>
<li>展示 Toast</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d.toast.show(&quot;Hello world&quot;)</span><br><span class="line">d.toast.show(&quot;Hello world&quot;, 1.0) # 显示为 1.0，默认为 1.0</span><br></pre></td></tr></table></figure>
<ul>
<li>获取 Toast</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># [参数]</span><br><span class="line"></span><br><span class="line"># 5.0: 最大等待超时。默认的 10.0</span><br><span class="line"></span><br><span class="line"># 缓存时间 10.0s。如果最近 10s 已经出现 toast，则返回缓存 toast。默认 10.0(将来可能会有变化)</span><br><span class="line"></span><br><span class="line"># 如果最终没有 toast，返回&quot;default message&quot;。默认没有</span><br><span class="line"></span><br><span class="line">d.toast.get_message(5.0, 10.0, &quot;default message&quot;)</span><br><span class="line"></span><br><span class="line"># 常见的使用</span><br><span class="line"></span><br><span class="line">assert &quot;Short message&quot; in d.toast.get_message(5.0, default=&quot;&quot;)</span><br><span class="line"></span><br><span class="line">#清楚缓存 toast</span><br><span class="line">d.toast.reset()</span><br><span class="line"></span><br><span class="line"># Now d.toast.get_message(0) is None</span><br></pre></td></tr></table></figure>
<h2 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a><a href="#XPath" title="XPath"></a>XPath</h2><ul>
<li>例如: 其中一个节点的内容</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;android.widget.TextView</span><br><span class="line">index=&quot;2&quot;</span><br><span class="line">text=&quot;05:19&quot;</span><br><span class="line">resource-id=&quot;com.netease.cloudmusic:id/qf&quot;</span><br><span class="line">package=&quot;com.netease.cloudmusic&quot;</span><br><span class="line">content-desc=&quot;&quot;</span><br><span class="line">checkable=&quot;false&quot; checked=&quot;false&quot; clickable=&quot;false&quot; enabled=&quot;true&quot; focusable=&quot;false&quot; focused=&quot;false&quot;</span><br><span class="line">scrol</span><br><span class="line">bounds=&quot;[957,1602][1020,1636]&quot; /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>xpath 定位和使用方法<br>有些属性的名字有修改需要注意</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">description -&gt; content-desc</span><br><span class="line">resourceId -&gt; resource-id</span><br></pre></td></tr></table></figure>
<ul>
<li>常见用法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 等待 10s</span><br><span class="line"></span><br><span class="line">d.xpath(&quot;//android.widget.TextView&quot;).wait(10.0)</span><br><span class="line"></span><br><span class="line"># 找到并单击</span><br><span class="line"></span><br><span class="line">d.xpath(&quot;//\*[@content-desc=&apos;分享&apos;]&quot;).click()</span><br><span class="line"></span><br><span class="line"># 检查是否存在</span><br><span class="line"></span><br><span class="line">if d.xpath(&quot;//android.widget.TextView[contains(@text, &apos;Se&apos;)]&quot;).exists:</span><br><span class="line">print(&quot;exists&quot;)</span><br><span class="line"></span><br><span class="line"># 获取所有文本视图文本、属性和中心点</span><br><span class="line"></span><br><span class="line">for elem in d.xpath(&quot;//android.widget.TextView&quot;).all():</span><br><span class="line">print(&quot;Text:&quot;, elem.text) #获取视图文本</span><br><span class="line">for elem in d.xpath(&quot;//android.widget.TextView&quot;).all():</span><br><span class="line">print(&quot;Attrib:&quot;, elem.attrib) #获取属性和中心点 #返回: (100, 200)</span><br><span class="line">for elem in d.xpath(&quot;//android.widget.TextView&quot;).all():</span><br><span class="line">print(&quot;Position:&quot;, elem.center())</span><br></pre></td></tr></table></figure>
<ul>
<li>其他 XPath 常见用法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 所有元素</span><br><span class="line"></span><br><span class="line">//\*</span><br><span class="line"></span><br><span class="line"># resource-id 包含 login 字符</span><br><span class="line"></span><br><span class="line">//\*[contains(@resource-id, &apos;login&apos;)]</span><br><span class="line"></span><br><span class="line"># 按钮包含账号或帐号</span><br><span class="line"></span><br><span class="line">//android.widget.Button[contains(@text, &apos;账号&apos;) or contains(@text, &apos;帐号&apos;)]</span><br><span class="line"></span><br><span class="line"># 所有 ImageView 中的第二个</span><br><span class="line"></span><br><span class="line">(//android.widget.ImageView)[2]</span><br><span class="line"></span><br><span class="line"># 所有 ImageView 中的最后一个</span><br><span class="line"></span><br><span class="line">(//android.widget.ImageView)[last()]</span><br><span class="line"></span><br><span class="line"># className 包含 ImageView</span><br><span class="line"></span><br><span class="line">//\*[contains(name(), &quot;ImageView&quot;)]</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>AILab-aida</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://ailab-aida.github.io/2019/09/29/UIAutomator2的使用/" title="UIAutomator2的使用">https://ailab-aida.github.io/2019/09/29/UIAutomator2的使用/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/iOS/" rel="tag"># iOS</a>
            
              <a href="/tags/Android/" rel="tag"># Android</a>
            
              <a href="/tags/python/" rel="tag"># python</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/09/29/Ubuntu faiss安装并利用flask提供向量搜索服务API/" rel="next" title="Ubuntu faiss安装并利用flask提供向量搜索服务API">
                  <i class="fa fa-chevron-left"></i> Ubuntu faiss安装并利用flask提供向量搜索服务API
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/09/29/基于分词标签的中文短文本相似度/" rel="prev" title="基于分词标签的中文短文本相似度">
                  基于分词标签的中文短文本相似度 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装-adb"><span class="nav-number">1.</span> <span class="nav-text">安装 adb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装-uiautomator2"><span class="nav-number">2.</span> <span class="nav-text">安装 uiautomator2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#如果你需要用到截图，安装-pillow"><span class="nav-number">3.</span> <span class="nav-text">如果你需要用到截图，安装 pillow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设备安装-atx-agent"><span class="nav-number">4.</span> <span class="nav-text">设备安装 atx-agent</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装-weditor"><span class="nav-number">5.</span> <span class="nav-text">安装 weditor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#【推荐】AppetizerIO-所见即所得脚本编辑器"><span class="nav-number">6.</span> <span class="nav-text">【推荐】AppetizerIO 所见即所得脚本编辑器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#调用-uiautomator2-的过程"><span class="nav-number">7.</span> <span class="nav-text">调用 uiautomator2 的过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#设备连接方法，有两种"><span class="nav-number">8.</span> <span class="nav-text">设备连接方法，有两种</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查并维持设备端守护进程处于运行状态"><span class="nav-number">9.</span> <span class="nav-text">检查并维持设备端守护进程处于运行状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#停用-UiAutomator-的守护程序"><span class="nav-number">10.</span> <span class="nav-text">停用 UiAutomator 的守护程序?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#打开调试开关"><span class="nav-number">11.</span> <span class="nav-text">打开调试开关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装应用，只能从-URL-安装"><span class="nav-number">12.</span> <span class="nav-text">安装应用，只能从 URL 安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#启动应用"><span class="nav-number">13.</span> <span class="nav-text">启动应用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#停止应用"><span class="nav-number">14.</span> <span class="nav-text">停止应用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#停止所有正在运行的应用程序"><span class="nav-number">15.</span> <span class="nav-text">停止所有正在运行的应用程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#跳过弹窗，禁止弹窗"><span class="nav-number">16.</span> <span class="nav-text">跳过弹窗，禁止弹窗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session"><span class="nav-number">17.</span> <span class="nav-text">Session</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取设备信息"><span class="nav-number">18.</span> <span class="nav-text">获取设备信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取应用信息"><span class="nav-number">19.</span> <span class="nav-text">获取应用信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#推拉文件"><span class="nav-number">20.</span> <span class="nav-text">推拉文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#关键事件"><span class="nav-number">21.</span> <span class="nav-text">关键事件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#手势与设备的交互"><span class="nav-number">22.</span> <span class="nav-text">手势与设备的交互</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#屏幕相关的"><span class="nav-number">23.</span> <span class="nav-text">屏幕相关的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#选择-Ui-对象"><span class="nav-number">24.</span> <span class="nav-text">选择 Ui 对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#获取所选-ui-对象状态及其信息"><span class="nav-number">25.</span> <span class="nav-text">获取所选 ui 对象状态及其信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#对选定-UI-对象的操作"><span class="nav-number">26.</span> <span class="nav-text">对选定 UI 对象的操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#特定-UI-对象的手势操作"><span class="nav-number">27.</span> <span class="nav-text">特定 UI 对象的手势操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#全局设置"><span class="nav-number">28.</span> <span class="nav-text">全局设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Input-method"><span class="nav-number">29.</span> <span class="nav-text">Input method</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Toast"><span class="nav-number">30.</span> <span class="nav-text">Toast</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#XPath"><span class="nav-number">31.</span> <span class="nav-text">XPath</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="AILab-aida">
  <p class="site-author-name" itemprop="name">AILab-aida</p>
  <div class="site-description" itemprop="description">涉猎的主要编程语言为 深度学习、机器学习、大数据、服务端、移动端、前端、爬虫(go、scala、Java、flutter、Python、react、Vue)等。</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/qq1074123922" title="GitHub &rarr; https://github.com/qq1074123922" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/1074123922@qq.com" title="E-Mail &rarr; 1074123922@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AILab-aida</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="/lib/pjax/pjax.min.js?v=0.2.8"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var id = element.id || '';
    var src = element.src || '';
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (id !=='') {
      script.id = element.id;
    }
    if (src !== '') {
      script.src = src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  








  <script src="/js/local-search.js?v=7.4.0"></script>













    <div id="pjax">

  

  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: 'a6d340a24e0f5044ffc3',
      clientSecret: 'edff6432acd3e21caff2696cc123e15b3ca3461c',
      repo: 'ailab-aida.github.io',
      owner: 'AILab-aida',
      admin: ['ailab'],
      id: 'a62ac97b8e07323f0150e3723f61dcf0',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>

    </div>
</body>
</html>
