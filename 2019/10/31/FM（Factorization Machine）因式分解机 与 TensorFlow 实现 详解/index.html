<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="AILab-aida" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: true,
    lazyload: false,
    pangu: true,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1ï¼Œçº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰çº¿æ€§å›å½’ï¼Œå³ä½¿ç”¨å¤šç»´ç©ºé—´ä¸­çš„ä¸€æ¡ç›´çº¿æ‹Ÿåˆæ ·æœ¬æ•°æ®ï¼Œå¦‚æœæ ·æœ¬ç‰¹å¾ä¸ºï¼šğ‘¥=(ğ‘¥1,ğ‘¥2,â€¦,ğ‘¥ğ‘›)x=(x1,x2,â€¦,xn)x = ({x_1},{x_2},â€¦,{x_n})æ¨¡å‹å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼šğ‘¦Ì‚ =â„(ğ‘¤,ğ‘)=ğ‘¤ğ‘‡ğ‘¥+ğ‘,ğ‘¤=(ğ‘¤1,ğ‘¤2,â€¦,ğ‘¤ğ‘›)y^=h(w,b)=wTx+b,w=(w1,w2,â€¦,wn)\h">
<meta name="keywords" content="ç®—æ³•">
<meta property="og:type" content="article">
<meta property="og:title" content="FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£">
<meta property="og:url" content="https://ailab-aida.github.io/2019/10/31/FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£/index.html">
<meta property="og:site_name" content="AILab-aida">
<meta property="og:description" content="1ï¼Œçº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰çº¿æ€§å›å½’ï¼Œå³ä½¿ç”¨å¤šç»´ç©ºé—´ä¸­çš„ä¸€æ¡ç›´çº¿æ‹Ÿåˆæ ·æœ¬æ•°æ®ï¼Œå¦‚æœæ ·æœ¬ç‰¹å¾ä¸ºï¼šğ‘¥=(ğ‘¥1,ğ‘¥2,â€¦,ğ‘¥ğ‘›)x=(x1,x2,â€¦,xn)x = ({x_1},{x_2},â€¦,{x_n})æ¨¡å‹å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼šğ‘¦Ì‚ =â„(ğ‘¤,ğ‘)=ğ‘¤ğ‘‡ğ‘¥+ğ‘,ğ‘¤=(ğ‘¤1,ğ‘¤2,â€¦,ğ‘¤ğ‘›)y^=h(w,b)=wTx+b,w=(w1,w2,â€¦,wn)\h">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-11-05T14:06:14.365Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£">
<meta name="twitter:description" content="1ï¼Œçº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰çº¿æ€§å›å½’ï¼Œå³ä½¿ç”¨å¤šç»´ç©ºé—´ä¸­çš„ä¸€æ¡ç›´çº¿æ‹Ÿåˆæ ·æœ¬æ•°æ®ï¼Œå¦‚æœæ ·æœ¬ç‰¹å¾ä¸ºï¼šğ‘¥=(ğ‘¥1,ğ‘¥2,â€¦,ğ‘¥ğ‘›)x=(x1,x2,â€¦,xn)x = ({x_1},{x_2},â€¦,{x_n})æ¨¡å‹å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼šğ‘¦Ì‚ =â„(ğ‘¤,ğ‘)=ğ‘¤ğ‘‡ğ‘¥+ğ‘,ğ‘¤=(ğ‘¤1,ğ‘¤2,â€¦,ğ‘¤ğ‘›)y^=h(w,b)=wTx+b,w=(w1,w2,â€¦,wn)\h">
  <link rel="canonical" href="https://ailab-aida.github.io/2019/10/31/FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£ | AILab-aida</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AILab-aida</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">ä¸€ä¸ªä¸“æ³¨æŠ€æœ¯çš„ç»„ç»‡</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>å…³äº</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-sitemap">
      
    

    <a href="/atom.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>åœ°å›¾</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="æœç´¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/qq1074123922" class="github-corner" title="AILab-aida GitHub" aria-label="AILab-aida GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="https://ailab-aida.github.io/2019/10/31/FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="AILab-aida">
      <meta itemprop="description" content="æ¶‰çŒçš„ä¸»è¦ç¼–ç¨‹è¯­è¨€ä¸º æ·±åº¦å­¦ä¹ ã€æœºå™¨å­¦ä¹ ã€å¤§æ•°æ®ã€æœåŠ¡ç«¯ã€ç§»åŠ¨ç«¯ã€å‰ç«¯ã€çˆ¬è™«(goã€scalaã€Javaã€flutterã€Pythonã€reactã€Vue)ç­‰ã€‚">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AILab-aida">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-10-31 17:52:13" itemprop="dateCreated datePublished" datetime="2019-10-31T17:52:13+08:00">2019-10-31</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-11-05 22:06:14" itemprop="dateModified" datetime="2019-11-05T22:06:14+08:00">2019-11-05</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/æ·±åº¦å­¦ä¹ /" itemprop="url" rel="index"><span itemprop="name">æ·±åº¦å­¦ä¹ </span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>1ï¼Œçº¿æ€§å›å½’ï¼ˆLinear Regressionï¼‰</p><p>çº¿æ€§å›å½’ï¼Œå³ä½¿ç”¨å¤šç»´ç©ºé—´ä¸­çš„ä¸€æ¡ç›´çº¿æ‹Ÿåˆæ ·æœ¬æ•°æ®ï¼Œå¦‚æœæ ·æœ¬ç‰¹å¾ä¸ºï¼š</p><p>ğ‘¥=(ğ‘¥1,ğ‘¥2,â€¦,ğ‘¥ğ‘›)x=(x1,x2,â€¦,xn)x = ({x_1},{x_2},â€¦,{x_n})</p><p>æ¨¡å‹å‡è®¾å‡½æ•°å¦‚ä¸‹ï¼š</p><p>ğ‘¦Ì‚ =â„(ğ‘¤,ğ‘)=ğ‘¤ğ‘‡ğ‘¥+ğ‘,ğ‘¤=(ğ‘¤1,ğ‘¤2,â€¦,ğ‘¤ğ‘›)y^=h(w,b)=wTx+b,w=(w1,w2,â€¦,wn)\hat y = h(w,b) = {w^T}x + b,w = ({w_1},{w_2},â€¦,{w_n})</p><a id="more"></a>




<p>ä»¥å‡æ–¹è¯¯å·®ä¸ºæ¨¡å‹æŸå¤±ï¼Œæ¨¡å‹è¾“å…¥æ ·æœ¬ä¸º (x(1),y(1)),(x(2),y(2)),â€¦,(x(m),y(m))ï¼ŒæŸå¤±å‡½æ•°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘™(ğ‘¤,ğ‘)=âˆ‘ğ‘—=1ğ‘š(ğ‘¦Ì‚Â (ğ‘—)âˆ’ğ‘¦(ğ‘—))2=âˆ‘ğ‘—=1ğ‘š(âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–+ğ‘âˆ’ğ‘¦(ğ‘—))l(w,b)=âˆ‘j=1m(y^(j)âˆ’y(j))2=âˆ‘j=1m(âˆ‘i=1nwixi(j)+bâˆ’y(j))l(w,b) = \sum\limits*&#123;j = 1&#125;^m &#123;&#123;&#123;(&#123;&#123;\hat y&#125;^&#123;(j)&#125;&#125; - &#123;y^&#123;(j)&#125;&#125;)&#125;^2&#125;&#125; Â = \sum\limits*&#123;j = 1&#125;^m &#123;(\sum\limits\_&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125; + b&#125; Â - &#123;y^&#123;(j)&#125;&#125;)&#125;</span><br></pre></td></tr></table></figure>
<p>2ï¼Œé€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰</p>
<p>çº¿æ€§å›å½’ç”¨äºé¢„æµ‹æ ‡è®°ä¸ºè¿ç»­çš„ï¼Œå°¤å…¶æ˜¯çº¿æ€§æˆ–å‡†çº¿æ€§çš„æ ·æœ¬æ•°æ®ï¼Œä½†æ˜¯æœ‰æ—¶æ ·æœ¬çš„æ ‡è®°ä¸ºç¦»æ•£çš„ï¼Œæœ€å…¸å‹çš„æƒ…å†µè«è¿‡äºæ ‡è®°ä¸º 0 æˆ–è€… 1ï¼Œæ­¤æ—¶çš„æ¨¡å‹è¢«ç§°ä¸ºåˆ†ç±»æ¨¡å‹ã€‚</p>
<p>ä¸ºäº†æ‰©å±•çº¿æ€§å›å½’åˆ°åˆ†ç±»ä»»åŠ¡ï¼Œéœ€è¦ä¸€ä¸ªå‡½æ•°å°† (-âˆ,+âˆ) æ˜ å°„åˆ° (0,1)ï¼ˆæˆ–è€…(-1,1) ç­‰ä»»æ„ä¸¤ä¸ªç¦»æ•£å€¼ï¼‰ï¼Œå‡½æ•°æœ€å¥½è¿ç»­å¯å¯¼ï¼Œå¹¶ä¸”åœ¨è‡ªå˜é‡è¶‹å‘äº -âˆ æ—¶æ— é™è¶‹è¿‘äºå› å˜é‡ä¸‹é™ï¼Œåœ¨è‡ªå˜é‡è¶‹å‘äº +âˆ æ—¶æ— é™è¶‹è¿‘äºå› å˜é‡ä¸Šé™ã€‚ç¬¦åˆæ¡ä»¶çš„å‡½æ•°æœ‰ä¸å°‘ï¼Œæ¯”å¦‚ tanh å‡½æ•°ï¼Œlogistic å‡½æ•°ã€‚</p>
<p>å¦‚æœæ˜ å°„å‡½æ•°é‡‡ç”¨ logistic å‡½æ•°ï¼Œè®¾æ¨¡å‹å‡è®¾å‡½æ•°ä¸ºæ ·æœ¬é¢„æµ‹åˆ†ç±»æ¦‚ç‡ï¼Œæ¨¡å‹å‡è®¾å‡½æ•°ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘ƒ(ğ‘¦=1)=â„(ğ‘¤,ğ‘)=11+ğ‘’âˆ’â„ğ‘™ğ‘–ğ‘›ğ‘’ğ‘ğ‘Ÿ(ğ‘¤,ğ‘)=11+ğ‘’âˆ’(ğ‘¤ğ‘‡ğ‘¥+ğ‘)ğ‘ƒ(ğ‘¦=0)=1âˆ’ğ‘ƒ(ğ‘¦=1)P(y=1)=h(w,b)=11+eâˆ’hlinear(w,b)=11+eâˆ’(wTx+b)P(y=0)=1âˆ’P(y=1)\begin&#123;array&#125;&#123;l&#125; P(y = 1) = h(w,b) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - &#123;h_&#123;linear&#125;&#125;(w,b)&#125;&#125;&#125;&#125; = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - (&#123;w^T&#125;x + b)&#125;&#125;&#125;&#125;\\ P(y = 0) = 1 - P(y = 1) \end&#123;array&#125;</span><br></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œå¯ä»¥ä»å¦ä¸€ä¸ªè§’åº¦è€ƒè™‘ä»å›å½’æ¨¡å‹æ‰©å±•ä¸ºåˆ†ç±»æ¨¡å‹ï¼Œä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln(ğ‘ƒ(ğ‘¦=1)ğ‘ƒ(ğ‘¦=0))=ln(â„(ğ‘¤,ğ‘)1âˆ’â„(ğ‘¤,ğ‘))=â„ğ‘™ğ‘–ğ‘›ğ‘’ğ‘ğ‘Ÿ(ğ‘¤,ğ‘)=ğ‘¤ğ‘‡ğ‘¥+ğ‘lnâ¡(P(y=1)P(y=0))=lnâ¡(h(w,b)1âˆ’h(w,b))=hlinear(w,b)=wTx+b\ln (\frac&#123;&#123;P(y = 1)&#125;&#125;&#123;&#123;P(y = 0)&#125;&#125;) = \ln (\frac&#123;&#123;h(w,b)&#125;&#125;&#123;&#123;1 - h(w,b)&#125;&#125;) = &#123;h\_&#123;linear&#125;&#125;(w,b) = &#123;w^T&#125;x + b</span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¯ä»¥å¾—åˆ°æ˜ å°„å‡½æ•°ä¸º logistic å‡½æ•°çš„å‡è®¾å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â„(ğ‘¤,ğ‘)=11+ğ‘’âˆ’(ğ‘¤ğ‘‡ğ‘¥+ğ‘)=11+ğ‘’âˆ’(âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥ğ‘–+ğ‘)h(w,b)=11+eâˆ’(wTx+b)=11+eâˆ’(âˆ‘i=1nwixi+b)h(w,b) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - (&#123;w^T&#125;x + b)&#125;&#125;&#125;&#125; = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - (\sum\limits_&#123;i = 1&#125;^n &#123;&#123;w_i&#125;&#123;x_i&#125;&#125; Â + b)&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼ˆè´Ÿï¼‰å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä½œä¸ºæŸå¤±å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘™(ğ‘¤,ğ‘)=âˆ’log(âˆğ‘—=1ğ‘šğ‘ƒ(ğ‘¦(ğ‘—)=1)ğ‘¦(ğ‘—)ğ‘ƒ(ğ‘¦(ğ‘—)=0)(1âˆ’ğ‘¦(ğ‘—)))=âˆ’âˆ‘ğ‘—=1ğ‘š(ğ‘¦(ğ‘—)logğ‘ƒ(ğ‘¦(ğ‘—)=1)+(1âˆ’ğ‘¦(ğ‘—))logğ‘ƒ(ğ‘¦(ğ‘—)=0))=âˆ’âˆ‘ğ‘—=1ğ‘š(ğ‘¦(ğ‘—)log(ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–))+(1âˆ’ğ‘¦(ğ‘—))log(1âˆ’ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–)),ğ‘”(ğ‘§)=11+ğ‘’âˆ’ğ‘§l(w,b)=âˆ’logâ¡(âˆj=1mP(y(j)=1)y(j)P(y(j)=0)(1âˆ’y(j)))=âˆ’âˆ‘j=1m(y(j)logâ¡P(y(j)=1)+(1âˆ’y(j))logâ¡P(y(j)=0))=âˆ’âˆ‘j=1m(y(j)logâ¡(g(b+âˆ‘i=1nwixi(j)))+(1âˆ’y(j))logâ¡(1âˆ’g(b+âˆ‘i=1nwixi(j))),g(z)=11+eâˆ’z\begin&#123;array&#125;&#123;l&#125; l(w,b) = - \log (\prod\limits*&#123;j = 1&#125;^m &#123;P&#123;&#123;(&#123;y^&#123;(j)&#125;&#125; = 1)&#125;^&#123;&#123;y^&#123;(j)&#125;&#125;&#125;&#125;P&#123;&#123;(&#123;y^&#123;(j)&#125;&#125; = 0)&#125;^&#123;(1 - &#123;y^&#123;(j)&#125;&#125;)&#125;&#125;&#125; )\\ = - \sum\limits*&#123;j = 1&#125;^m &#123;(&#123;y^&#123;(j)&#125;&#125;\log P(&#123;y^&#123;(j)&#125;&#125; = 1) + (1 - &#123;y^&#123;(j)&#125;&#125;)\log P(&#123;y^&#123;(j)&#125;&#125; = 0))&#125; \\ = - \sum\limits*&#123;j = 1&#125;^m &#123;(&#123;y^&#123;(j)&#125;&#125;\log (g(b + \sum\limits*&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125;&#125; )) + (1 - &#123;y^&#123;(j)&#125;&#125;)\log (1 - g(b + \sum\limits\_&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125;&#125; ))&#125; ,g(z) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - z&#125;&#125;&#125;&#125; \end&#123;array&#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæ ·æœ¬åŒ…å«ä¸€äº›ç¦»æ•£çš„ label ç‰¹å¾ï¼Œè¿™äº›ç‰¹å¾å¾ˆéš¾è¿ç»­é‡åŒ–ï¼Œæœ€ç®€å•çš„å¤„ç†æ–¹å¼å°±æ˜¯ one-hotï¼Œå³å°†ç¦»æ•£çš„æ¯ä¸ªæ•°æ˜ å°„åˆ°å¤šç»´ç©ºé—´ä¸­çš„ä¸€ç»´ã€‚ç¦»æ•£ç‰¹å¾åŒ…å«å¤šå°‘ä¸ªå¯èƒ½å€¼ï¼Œè½¬æ¢åçš„ç‰¹å¾å°±åŒ…å«å¤šå°‘ç»´ã€‚è¿™æ ·å¤„ç†åæ ·æœ¬ç‰¹å¾çš„ç»´æ•°ä¼šå˜å¾—éå¸¸å·¨å¤§ï¼Œå¦å¤–å¤§éƒ¨åˆ†ç»´åº¦çš„å€¼éƒ½æ˜¯ 0ã€‚</p>
<p>ä¸€æ–¹é¢ï¼Œé€»è¾‘å›å½’æ ¸å¿ƒæ˜¯ä¸€ä¸ªçº¿æ€§æ¨¡å‹ï¼Œå› æ­¤è®¡ç®—è§„æ¨¡éšç€æ ·æœ¬ç‰¹å¾æ•°çš„å¢é•¿è€Œçº¿æ€§å¢é•¿ï¼Œç›¸è¾ƒå…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯´è®¡ç®—é‡ï¼ˆéšç‰¹å¾æ•°å¢é•¿ï¼‰çš„å¢é•¿ç‡è¾ƒå°ï¼›å¦ä¸€æ–¹é¢ï¼Œé€»è¾‘å›å½’å‡è®¾å‡½æ•°ä¸æŸå¤±å‡½æ•°ä¸­ï¼Œå„ä¸ªç‰¹å¾å¯¹äºç»“æœæ˜¯ç‹¬ç«‹èµ·ä½œç”¨çš„ï¼Œå› æ­¤åœ¨æ ·æœ¬æ•°è¶³å¤Ÿçš„å‰æä¸‹ï¼Œä¹Ÿä¸ä¼šå—åˆ°å¤§é‡å€¼ä¸º 0 çš„ç‰¹å¾çš„å¹²æ‰°ã€‚å› æ­¤ç‰¹åˆ«é€‚åˆè¿™ç±»åœºæ™¯ä¸‹çš„åˆ†ç±»é—®é¢˜ã€‚</p>
<p>3ï¼Œå› å¼åˆ†è§£æœºï¼ˆFactorization Machineï¼‰</p>
<p>é€»è¾‘å›å½’æœ€å¤§çš„ä¼˜åŠ¿æ˜¯ç®€å•ï¼Œæœ€å¤§çš„åŠ£åŠ¿ä¹Ÿæ˜¯å¤ªç®€å•ï¼Œæ²¡æœ‰è€ƒè™‘ç‰¹å¾ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹ç‰¹å¾è¿›è¡Œé¢„å¤„ç†ã€‚å› æ­¤å°±æœ‰äº†åŒ…å«ç‰¹å¾ä¸¤ä¸¤äº¤å‰é¡¹çš„å‡è®¾å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â„(ğ‘¤,ğ‘)=ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥ğ‘–+âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›ğœ”ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¥ğ‘—),ğ‘”(ğ‘§)=11+ğ‘’âˆ’ğ‘§h(w,b)=g(b+âˆ‘i=1nwixi+âˆ‘i=1nâˆ‘j=i+1nÏ‰ijxixj),g(z)=11+eâˆ’zh(w,b) = g(b + \sum\limits*&#123;i = 1&#125;^n &#123;&#123;w_i&#125;&#123;x_i&#125;&#125; Â + \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;&#123;\omega *&#123;ij&#125;&#125;&#123;x_i&#125;&#125; &#123;x_j&#125;&#125; ),g(z) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - z&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶æœ‰ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œç”±äºç‰¹å¾ç»´æ•°æœ‰å¯èƒ½æ˜¯éå¸¸å·¨å¤§çš„ï¼Œå¾ˆæœ‰å¯èƒ½è®­ç»ƒæ ·æœ¬ä¸­æœ‰ä¸€äº›ç‰¹å¾ç»„åˆ xixjï¼ˆxiã€xj éƒ½ä¸ä¸º 0ï¼‰æ˜¯å®Œå…¨ä¸å­˜åœ¨çš„ï¼Œè¿™æ · Ï‰ij å°±æ— æ³•å¾—åˆ°è®­ç»ƒã€‚å®é™…ä½¿ç”¨æ¨¡å‹æ—¶ï¼Œå¦‚æœå‡ºç°ç‰¹å¾ç»„åˆ xixjï¼Œæ¨¡å‹å°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>
<p>ä¸ºäº†å‡å°è®­ç»ƒè®¡ç®—é‡ï¼Œä¹Ÿä¸ºäº†è§„é¿ä¸Šé¢è¯´çš„è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¼•å…¥è¾…åŠ©çŸ©é˜µ vï¼Œn ä¸ºç‰¹å¾æ€»ç»´æ•°ï¼Œk ä¸ºè¶…å‚æ•°</p>
<p>ğ‘£âˆˆğ‘…ğ‘›âˆ—ğ‘˜vâˆˆRnâˆ—kv \in {R^{n*k}}</p>
<p>ç„¶åä½¿ç”¨ vvT ä»£æ›¿å‚æ•°çŸ©é˜µ Ï‰ï¼Œå¯å¾—</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğœ”ğ‘–ğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘‡ğ‘Ÿğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘ŸÏ‰ij=âˆ‘r=1kvirvrjT=âˆ‘r=1kvirvjr&#123;\omega _&#123;ij&#125;&#125; = \sum\limits_&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;v*&#123;rj&#125;^T&#125; Â = \sum\limits*&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;&#123;v\_&#123;jr&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>å¯å¾—å‡è®¾å‡½æ•°çº¿æ€§éƒ¨åˆ†æœ€åä¸€é¡¹å¯åŒ–ç®€ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›ğœ”ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¥ğ‘—=âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜(âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘—)=12âˆ‘ğ‘Ÿ=1ğ‘˜(âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘—âˆ’âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘–)=12âˆ‘ğ‘Ÿ=1ğ‘˜(âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–âˆ‘ğ‘—=1ğ‘›ğ‘£ğ‘—ğ‘Ÿğ‘¥ğ‘—âˆ’âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘–)=12âˆ‘ğ‘Ÿ=1ğ‘˜((âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–)2âˆ’âˆ‘ğ‘–=1ğ‘›(ğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–)2)âˆ‘i=1nâˆ‘j=i+1nÏ‰ijxixj=âˆ‘i=1nâˆ‘j=i+1nâˆ‘r=1kvirvjrxixj=âˆ‘r=1k(âˆ‘i=1nâˆ‘j=i+1nvirvjrxixj)=12âˆ‘r=1k(âˆ‘i=1nâˆ‘j=1nvirvjrxixjâˆ’âˆ‘i=1nvirvirxixi)=12âˆ‘r=1k(âˆ‘i=1nvirxiâˆ‘j=1nvjrxjâˆ’âˆ‘i=1nvirvirxixi)=12âˆ‘r=1k((âˆ‘i=1nvirxi)2âˆ’âˆ‘i=1n(virxi)2)\begin&#123;array&#125;&#123;l&#125; \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;&#123;\omega _&#123;ij&#125;&#125;&#123;x*i&#125;&#125; &#123;x_j&#125;&#125; \\ = \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;\sum\limits*&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;jr&#125;&#125;&#123;x_i&#125;&#123;x_j&#125;&#125; &#125; &#125; \\ = \sum\limits*&#123;r = 1&#125;^k &#123;(\sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;jr&#125;&#125;&#123;x_i&#125;&#123;x_j&#125;)&#125; &#125; &#125; \\ = \frac&#123;1&#125;&#123;2&#125;\sum\limits*&#123;r = 1&#125;^k &#123;(\sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;jr&#125;&#125;&#123;x_i&#125;&#123;x_j&#125;&#125; &#125; - \sum\limits*&#123;i = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;ir&#125;&#125;&#123;x_i&#125;&#123;x_i&#125;&#125; )&#125; \\ = \frac&#123;1&#125;&#123;2&#125;\sum\limits*&#123;r = 1&#125;^k &#123;(\sum\limits*&#123;i = 1&#125;^n &#123;&#123;v*&#123;ir&#125;&#125;&#123;x*i&#125;&#125; \sum\limits*&#123;j = 1&#125;^n &#123;&#123;v_&#123;jr&#125;&#125;&#123;x*j&#125;&#125; - \sum\limits*&#123;i = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;ir&#125;&#125;&#123;x_i&#125;&#123;x_i&#125;&#125; )&#125; \\ = \frac&#123;1&#125;&#123;2&#125;\sum\limits*&#123;r = 1&#125;^k &#123;(&#123;&#123;(\sum\limits_&#123;i = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;x*i&#125;&#125; )&#125;^2&#125; - \sum\limits*&#123;i = 1&#125;^n &#123;&#123;&#123;(&#123;v_&#123;ir&#125;&#125;&#123;x_i&#125;)&#125;^2&#125;&#125; )&#125; \end&#123;array&#125;</span><br></pre></td></tr></table></figure>
<p>åŒé€»è¾‘å›å½’ä¸€æ ·ï¼Œä»¤æ¨¡å‹å‡è®¾å‡½æ•°ä¸ºæ ·æœ¬é¢„æµ‹åˆ†ç±»æ¦‚ç‡ï¼Œè¿˜æ˜¯ä½¿ç”¨ï¼ˆè´Ÿï¼‰å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºæŸå¤±å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘™(ğ‘,ğ‘¤,ğ‘£)=âˆ’log(âˆğ‘—=1ğ‘šğ‘ƒ(ğ‘¦(ğ‘—)=1)ğ‘¦(ğ‘—)ğ‘ƒ(ğ‘¦(ğ‘—)=0)(1âˆ’ğ‘¦(ğ‘—)))=âˆ’âˆ‘ğ‘—=1ğ‘š(ğ‘¦(ğ‘—)log(â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—))+(1âˆ’ğ‘¦(ğ‘—))log(1âˆ’â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—)))â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—)=ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–+12âˆ‘ğ‘Ÿ=1ğ‘˜((âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘¥(ğ‘—)ğ‘–)2âˆ’âˆ‘ğ‘–=1ğ‘›(ğ‘£ğ‘–ğ‘Ÿğ‘¥(ğ‘—)ğ‘–)2))ğ‘”(ğ‘§)=11+ğ‘’âˆ’ğ‘§l(b,w,v)=âˆ’logâ¡(âˆj=1mP(y(j)=1)y(j)P(y(j)=0)(1âˆ’y(j)))=âˆ’âˆ‘j=1m(y(j)logâ¡(h(w,b)|x=x(j))+(1âˆ’y(j))logâ¡(1âˆ’h(w,b)|x=x(j)))h(w,b)|x=x(j)=g(b+âˆ‘i=1nwixi(j)+12âˆ‘r=1k((âˆ‘i=1nvirxi(j))2âˆ’âˆ‘i=1n(virxi(j))2))g(z)=11+eâˆ’z\begin&#123;array&#125;&#123;l&#125; l(b,w,v) = - \log (\prod\limits*&#123;j = 1&#125;^m &#123;P&#123;&#123;(&#123;y^&#123;(j)&#125;&#125; = 1)&#125;^&#123;&#123;y^&#123;(j)&#125;&#125;&#125;&#125;P&#123;&#123;(&#123;y^&#123;(j)&#125;&#125; = 0)&#125;^&#123;(1 - &#123;y^&#123;(j)&#125;&#125;)&#125;&#125;&#125; ) = - \sum\limits*&#123;j = 1&#125;^m &#123;(&#123;y^&#123;(j)&#125;&#125;\log (h(w,b)&#123;|_&#123;x = &#123;x^&#123;(j)&#125;&#125;&#125;&#125;) + (1 - &#123;y^&#123;(j)&#125;&#125;)\log (1 - h(w,b)&#123;|_&#123;x = &#123;x^&#123;(j)&#125;&#125;&#125;&#125;))&#125; \\ h(w,b)&#123;|_&#123;x = &#123;x^&#123;(j)&#125;&#125;&#125;&#125; = g(b + \sum\limits_&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125;&#125; + \frac&#123;1&#125;&#123;2&#125;\sum\limits*&#123;r = 1&#125;^k &#123;(&#123;&#123;(\sum\limits*&#123;i = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;x*i^&#123;(j)&#125;&#125; )&#125;^2&#125; - \sum\limits*&#123;i = 1&#125;^n &#123;&#123;&#123;(&#123;v_&#123;ir&#125;&#125;x_i^&#123;(j)&#125;)&#125;^2&#125;&#125; )&#125; )\\ g(z) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - z&#125;&#125;&#125;&#125; \end&#123;array&#125;</span><br></pre></td></tr></table></figure>
<p>4ï¼Œå…³äº FM å‡è®¾å‡½æ•°çš„è®¨è®º</p>
<p>ä»”ç»†çœ‹ FM å‡è®¾å‡½æ•°çº¿æ€§éƒ¨åˆ†æœ€åä¸€é¡¹çš„åŒ–ç®€è¿‡ç¨‹ï¼Œä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ª â€œåŒ–ç®€â€ è¿‡ç¨‹ä»…ä»…æ˜¯åŒ–ç®€äº†å¼å­çš„å½¢å¼ï¼Œå…¶å®å¹¶æ²¡æœ‰å‡å°‘è®¡ç®—é‡ï¼Œåå€’æ˜¯å¢åŠ äº†è®¡ç®—é‡ï¼Œå¦‚æœå‡è®¾å‡½æ•°ä¸æ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â„(ğ‘¤,ğ‘)=ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥ğ‘–+âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›ğœ”ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¥ğ‘—)h(w,b)=g(b+âˆ‘i=1nwixi+âˆ‘i=1nâˆ‘j=i+1nÏ‰ijxixj)h(w,b) = g(b + \sum\limits*&#123;i = 1&#125;^n &#123;&#123;w_i&#125;&#123;x_i&#125;&#125; Â + \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;&#123;\omega *&#123;ij&#125;&#125;&#123;x_i&#125;&#125; &#123;x_j&#125;&#125; )</span><br></pre></td></tr></table></figure>
<p>è€Œæ˜¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â„(ğ‘¤,ğ‘)=ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥ğ‘–+âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=1ğ‘›ğœ”ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¥ğ‘—)h(w,b)=g(b+âˆ‘i=1nwixi+âˆ‘i=1nâˆ‘j=1nÏ‰ijxixj)h(w,b) = g(b + \sum\limits*&#123;i = 1&#125;^n &#123;&#123;w_i&#125;&#123;x_i&#125;&#125; Â + \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = 1&#125;^n &#123;&#123;\omega *&#123;ij&#125;&#125;&#123;x_i&#125;&#125; &#123;x_j&#125;&#125; )</span><br></pre></td></tr></table></figure>
<p>è¡¨é¢ä¸Šçœ‹å‡è®¾å‡½æ•°å¢åŠ äº†è‹¥å¹²é¡¹ï¼Œ ä½†ç»è¿‡åŒ–ç®€åï¼Œå¯å¾—çº¿æ€§éƒ¨åˆ†æœ€åä¸€é¡¹ä¸ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=1ğ‘›ğœ”ğ‘–ğ‘—ğ‘¥ğ‘–ğ‘¥ğ‘—=âˆ‘ğ‘–=1ğ‘›âˆ‘ğ‘—=ğ‘–+1ğ‘›âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘Ÿğ‘¥ğ‘–ğ‘¥ğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜((âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘¥ğ‘–)2)âˆ‘i=1nâˆ‘j=1nÏ‰ijxixj=âˆ‘i=1nâˆ‘j=i+1nâˆ‘r=1kvirvjrxixj=âˆ‘r=1k((âˆ‘i=1nvirxi)2)\sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = 1&#125;^n &#123;&#123;\omega _&#123;ij&#125;&#125;&#123;x*i&#125;&#125; &#123;x_j&#125;&#125; Â = \sum\limits*&#123;i = 1&#125;^n &#123;\sum\limits*&#123;j = i + 1&#125;^n &#123;\sum\limits*&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;&#123;v*&#123;jr&#125;&#125;&#123;x_i&#125;&#123;x_j&#125;&#125; &#125; &#125; Â = \sum\limits*&#123;r = 1&#125;^k &#123;(&#123;&#123;(\sum\limits_&#123;i = 1&#125;^n &#123;&#123;v_&#123;ir&#125;&#125;&#123;x_i&#125;&#125; )&#125;^2&#125;)&#125;</span><br></pre></td></tr></table></figure>
<p>åå€’æ˜¯æ›´ç®€å•äº†ï¼Œä¸ºä»€ä¹ˆä¸ç”¨åé¢å¼å­è®¡ç®—ï¼Œè€Œè¦ç”¨æ›´å¤æ‚çš„å‰è€…å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯ç”±äº Ï‰ çš„æ¯ä¸€é¡¹å¹¶ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† vvT ä»£æ›¿äº† Ï‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğœ”ğ‘–ğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘‡ğ‘Ÿğ‘—=âˆ‘ğ‘Ÿ=1ğ‘˜ğ‘£ğ‘–ğ‘Ÿğ‘£ğ‘—ğ‘ŸÏ‰ij=âˆ‘r=1kvirvrjT=âˆ‘r=1kvirvjr&#123;\omega _&#123;ij&#125;&#125; = \sum\limits_&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;v*&#123;rj&#125;^T&#125; Â = \sum\limits*&#123;r = 1&#125;^k &#123;&#123;v_&#123;ir&#125;&#125;&#123;v\_&#123;jr&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>å³å¯è®¤ä¸º vi=(vi1,vi2,â€¦,vik) ä»£è¡¨äº†ç‰¹å¾ i ä¸å…¶ä»–ç‰¹å¾äº¤å‰å…³ç³»çš„éšè—ç‰¹å¾</p>
<p>å¦‚æœä¸å»æ‰äº¤å‰ç‰¹å¾ä¸­çš„ xixi é¡¹ï¼Œåˆ™ç­‰åŒäº vi ä¸ä»…éšå«äº†äº¤å‰å…³ç³»ï¼Œè¿˜éšå«äº† xi çš„äºŒæ¬¡é¡¹ï¼Œä¸ç¬¦åˆæˆ‘ä»¬çš„åˆè¡·</p>
<p>5ï¼ŒTensorFlow æ¦‚è¿°</p>
<p>TensorFlow å³ tensor+flowï¼Œtensor æŒ‡æ•°æ®ï¼Œä»¥ä»»æ„ç»´çš„ç±»å‹åŒ–æ•°ç»„ä¸ºå…·ä½“å½¢å¼ï¼Œflow åˆ™æŒ‡æ•°æ®çš„æµå‘</p>
<blockquote>
<p>æè¿° flow æœ‰ä¸‰ä¸ªå±‚æ¬¡çš„æ¦‚å¿µï¼š</p>
<ul>
<li>operationï¼šæ˜¯æœ€åŸºæœ¬çš„å•å…ƒï¼Œæ¯ä¸ª operation è·å¾— 0 ä¸ªæˆ–å¤šä¸ª tensorï¼Œäº§ç”Ÿ 0 ä¸ªæˆ–å¤šä¸ª tensorã€‚operation å¯èƒ½ä¸ºè·å–ä¸€ä¸ªå¸¸é‡ tf.constant()ï¼Œè·å–ä¸€ä¸ªå˜é‡ tf.get_variable() æˆ–è€…è¿›è¡Œä¸€ä¸ªæ“ä½œï¼Œæ¯”å¦‚åŠ æ³• tf.add()ã€ä¹˜æ³• tf.multiply()ã€‚</li>
<li>graphï¼šå®šä¹‰äº†æ•°æ®æµï¼Œç”± tf.Graph() åˆå§‹åŒ–ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹çœç•¥ï¼‰ã€‚graph ç”±èŠ‚ç‚¹å’ŒèŠ‚ç‚¹é—´çš„è¿çº¿æ„æˆï¼Œgraph ä¸­çš„èŠ‚ç‚¹å³ operationã€‚graph æ˜¯å¯¹æ•°æ®æµå‘ç»„æˆçš„ç½‘ç»œç»“æ„çš„å®šä¹‰ï¼Œæœ¬èº«å¹¶ä¸è¿›è¡Œä»»ä½•è®¡ç®—ã€‚</li>
<li>sessionï¼šå®šä¹‰äº† graph è¿è¡Œçš„ç¯å¢ƒï¼Œç”± tf.Session() åˆå§‹åŒ–ã€‚session ä¸­å¯ä»¥è¿è¡Œ graph ä¸­ä¸€ä¸ªæˆ–å¤šä¸ª operationï¼Œå¯ä»¥åœ¨è¿è¡Œå‰é€šè¿‡ feed ç»™ operation è¾“å…¥æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿”å›å€¼è·å–è®¡ç®—ç»“æœã€‚</li>
</ul>
<p>æ¦‚å¿µä¸Šè®²ï¼Œå›¾ä¸­æ‰€æœ‰èŠ‚ç‚¹é—´çš„è¿çº¿éƒ½æ˜¯ tensorï¼Œä½†æ€»éœ€è¦æœ‰ä¸€äº›æ•°æ®ä½œä¸ºæ•°æ®æ¥æºï¼Œæè¿°è¿™äº›æ•°æ®æ¥æºçš„ç»„ä»¶æœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p>
<ul>
<li>å¸¸é‡ï¼šç”¨ tf.constant() å®šä¹‰ï¼Œå³è¿è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šæ”¹å˜çš„æ•°æ®ï¼Œä¸€èˆ¬ç”¨æ¥ä¿å­˜ä¸€äº›å›ºæœ‰å‚æ•°ã€‚å¸¸é‡å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ª operationï¼Œè¾“å…¥ä¸ºç©ºï¼Œè¾“å‡ºä¸ºå¸¸æ•°ï¼ˆæ•°ç»„ï¼‰ã€‚</li>
<li>å˜é‡ï¼šç†è®ºä¸Šå¹¿ä¹‰çš„å˜é‡åŒ…å«æ‰€æœ‰é™¤å¸¸é‡ä»¥å¤–çš„æ‰€æœ‰ tensorï¼Œè¿™é‡Œçš„å˜é‡ä¸“æŒ‡ tf.Variable()ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ TensorFlow ä¸­ï¼Œå°å†™å¼€å¤´çš„æ‰æ˜¯ operationï¼Œå¤§å†™å¼€å¤´çš„éƒ½æ˜¯ç±»ï¼Œå› æ­¤ tf.Variable() ä¸æ˜¯ä¸€ä¸ª operationï¼Œè€Œæ˜¯åŒ…å«äº†ä¸€ç³»åˆ— operationï¼Œå¦‚åˆå§‹åŒ–ã€èµ‹å€¼çš„ç±»æˆå‘˜ã€‚æ¯ä¸ª graph è¿è¡Œå‰å¿…é¡»åˆå§‹åŒ–æ‰€æœ‰ä½¿ç”¨åˆ°çš„å˜é‡ã€‚</li>
<li>å ä½ç¬¦ï¼šç”¨ tf.placeholder() å®šä¹‰ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ operationï¼Œä¸éœ€è¦åˆå§‹åŒ–ï¼Œä½†éœ€è¦åœ¨è¿è¡Œä¸­é€šè¿‡ feed æ¥æ”¶æ•°æ®ã€‚</li>
</ul>
</blockquote>
<p>6ï¼ŒLR çš„ TensorFlow å®ç°</p>
<p>é¦–å…ˆéœ€è¦å®šä¹‰è¾“å…¥æ ·æœ¬çš„ç‰¹å¾ç»´åº¦å’Œæ¥æ”¶è¾“å…¥æ ·æœ¬ç‰¹å¾å’Œæ ·æœ¬æ ‡ç­¾çš„å ä½ç¬¦ã€‚</p>
<p>ç‰¹å¾ç»´åº¦å¯ä»¥ä½¿ç”¨æ™®é€š python å˜é‡æŒ‡å®šï¼Œæ­¤æ—¶ç­‰åŒäºä½¿ç”¨ tf.constant åˆ›å»ºäº†ä¸€ä¸ªå¸¸é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">FEATURE_NUM = 8</span><br><span class="line">#shapeå‚æ•°çš„åˆ—è¡¨é•¿åº¦ä»£è¡¨å ä½ç¬¦çš„ç»´åº¦</span><br><span class="line">#å¦‚æœshapeä¸ä¸ºNoneï¼Œåˆ™è¾“å…¥æ•°æ®ç»´åº¦å¿…é¡»ç­‰åŒäºshapeå‚æ•°åˆ—è¡¨é•¿åº¦</span><br><span class="line">#æ¯ä¸€ç»´çš„å¤§å°å¯ä»¥ä¸æŒ‡å®šï¼ˆä¸ºNoneï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šï¼Œå¦‚æœæŒ‡å®šåˆ™è¾“å…¥æ•°æ®è¯¥ç»´åº¦é•¿åº¦å¿…é¡»ä¸shapeæŒ‡å®šçš„ä¸€è‡´</span><br><span class="line">x = tf.placeholder(tf.float32, shape=[None, FEATURE_NUM])</span><br><span class="line">#ç­‰åŒäºx = tf.placeholder(tf.float32, shape=[None, tf.constant(FEATURE_NUM, dtype=tf.int64)])</span><br><span class="line">y = tf.placeholder(tf.int32, shape=[None])</span><br></pre></td></tr></table></figure>
<p>ä¸å¯ä»¥é€šè¿‡ä½¿ç”¨ placeholder æŒ‡å®šç‰¹å¾ç»´åº¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = tf.placeholder(tf.int32, shape=None)</span><br><span class="line">x = tf.placeholder(tf.float32, shape=[None, m])  #æ— æ³•æ‰§è¡Œ</span><br><span class="line">y = tf.placeholder(tf.int32, shape=[None])</span><br></pre></td></tr></table></figure>
<p>è™½ç„¶ placeholder åˆå§‹ shape ä¸­ä¸èƒ½åŒ…å«å…¶ä»– tensorï¼Œä½†å¯ä»¥æ ¹æ®è¾“å…¥æ ·æœ¬çš„åˆ—æ•°åŠ¨æ€æŒ‡å®š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = tf.placeholder(tf.float32, shape=[None, None])  #æˆ–è€…å¯ä»¥ä¸æŒ‡å®šç»´æ•°ï¼Œè¾“å…¥shape=Noneï¼Œæ­¤æ—¶å¯ä»¥è¾“å…¥ä»»æ„ç»´æ•°ï¼Œä»»æ„å¤§å°çš„æ•°æ®</span><br><span class="line">y = tf.placeholder(tf.int32, shape=[None])</span><br><span class="line">m = tf.shape(x)[1]  #æ­¤å¤„ä¸èƒ½ä½¿ç”¨x.get_shape()[1].valueï¼Œget_shape()è·å–çš„ç»“æœä¸ºé™æ€å¤§å°ï¼Œè¿”å›ç»“æœä¸º[None,None]</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥è¦å®šä¹‰æ”¾ç½® LR å‡è®¾å‡½æ•°ä¸­ w ä¸ b çš„å˜é‡ï¼Œåœ¨å®šä¹‰å‚æ•° w å‰ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ª w çš„åˆå§‹å€¼ã€‚å¯¹äº LR æ¥è¯´ï¼Œå‚æ•°åˆå§‹å€¼ä¸ºéšæœºæ•°æˆ–è€…å…¨é›¶éƒ½æ²¡å…³ç³»ï¼Œå› ä¸º LR çš„æŸå¤±å‡½æ•°ä¸€å®šæ˜¯å‡¸å‡½æ•°ï¼ˆæ±‚äºŒé˜¶å¯¼æ•°å¯çŸ¥ï¼‰ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹è¿˜æ˜¯ä¹ æƒ¯é‡‡ç”¨éšæœºæ•°åˆå§‹åŒ–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#å¸¸ç”¨çš„éšæœºå‡½æ•°æœ‰random_uniformã€random_normalå’Œtruncated_normal</span><br><span class="line">#åˆ†åˆ«æ˜¯å‡åŒ€åˆ†å¸ƒã€æ­£æ€åˆ†å¸ƒã€è¢«æˆªæ–­çš„æ­£æ€åˆ†å¸ƒ</span><br><span class="line">weight_init = tf.truncated_normal(shape=[FEATURE_NUM, 1],mean=0.0,stddev=1.0)  #æ­¤å¤„shapeåˆå§‹åŒ–åªèƒ½ä½¿ç”¨å¸¸é‡ï¼Œä¸æ”¯æŒä½¿ç”¨tensor</span><br><span class="line">weight = tf.Variable(weight_init)</span><br><span class="line">bais = tf.Variable([0.0])</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†ä¿æŒä¹ æƒ¯ç”¨æ³•ï¼Œå°†ä¸€ç»´å‘é‡ y æ‰©å±•ä¸ºäºŒç»´åˆ—å‘é‡ï¼ŒTensorFlow ä¸­æ‰©ç»´å¯ä»¥ä½¿ç”¨ tf.expand_dims() æˆ–è€… tf.reshape()ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y_expand = tf.expand_dims(y, axis=1)  #æ–¹æ³•1ï¼Œaxisè¡¨ç¤ºåœ¨åŸè‹¥å¹²ä¸ªç»´åº¦çš„é—´éš”ä¸­ç¬¬å‡ ä¸ªä½ç½®æ’å…¥æ–°ç»´åº¦</span><br><span class="line">y_expand = tf.reshape(y, shape=[tf.shape(x)[0],1])  #æ–¹æ³•2ï¼Œshapeä¸ºè¾“å‡ºçš„ç»´åº¦å€¼</span><br><span class="line">y_expand = tf.reshape(y, shape=[-1,1])  #æ–¹æ³•3ï¼Œshapeå‚æ•°åˆ—è¡¨ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªå‚æ•°æœªçŸ¥ï¼Œå†™ä¸º-1</span><br></pre></td></tr></table></figure>
<p>å¯çŸ¥ï¼š</p>
<p>ğ‘¥âˆˆğ‘…ğ‘šâˆ—ğ‘›,ğ‘¦âˆˆğ‘…ğ‘šâˆ—1,ğ‘¤âˆˆğ‘…ğ‘›âˆ—1,ğ‘âˆˆğ‘…0xâˆˆRmâˆ—n,yâˆˆRmâˆ—1,wâˆˆRnâˆ—1,bâˆˆR0x \in {R^{m<em>n}},y \in {R^{m</em>1}},w \in {R^{n*1}},b \in {R^0}</p>
<p>å›å¤´çœ‹ LR æŸå¤±å‡½æ•°çš„å®šä¹‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘™(ğ‘¤,ğ‘)=âˆ’âˆ‘ğ‘—=1ğ‘š(ğ‘¦(ğ‘—)log(ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–))+(1âˆ’ğ‘¦(ğ‘—))log(1âˆ’ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–)),ğ‘”(ğ‘§)=11+ğ‘’âˆ’ğ‘§l(w,b)=âˆ’âˆ‘j=1m(y(j)logâ¡(g(b+âˆ‘i=1nwixi(j)))+(1âˆ’y(j))logâ¡(1âˆ’g(b+âˆ‘i=1nwixi(j))),g(z)=11+eâˆ’zl(w,b) = Â - \sum\limits*&#123;j = 1&#125;^m &#123;(&#123;y^&#123;(j)&#125;&#125;\log (g(b + \sum\limits*&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125;&#125; )) + (1 - &#123;y^&#123;(j)&#125;&#125;)\log (1 - g(b + \sum\limits\_&#123;i = 1&#125;^n &#123;&#123;w_i&#125;x_i^&#123;(j)&#125;&#125; ))&#125; ,g(z) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - z&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åœ¨ TensorFlow ä¸­ï¼Œâ€œ+â€ ç­‰åŒäº tf.add()ï¼Œâ€œ-â€ ç­‰åŒäº tf.subtract()ï¼Œâ€œ*â€ ç­‰åŒäº tf.multiply()ï¼Œâ€œ/â€ ç­‰åŒäº tf.div()ï¼Œæ‰€æœ‰è¿™äº›æ“ä½œæ˜¯ â€œé€é¡¹æ“ä½œâ€ï¼š</p>
<ul>
<li>å¦‚æœä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸ºæ ‡é‡ï¼Œåˆ™ç»“æœä¸ºæ ‡é‡</li>
<li>å¦‚æœä¸€ä¸ªæ“ä½œæ•°ä¸ºæ ‡é‡ï¼Œå¦ä¸€ä¸ªæ“ä½œæ•°ä¸ºå‘é‡ï¼Œåˆ™æ ‡é‡ä¼šåˆ†åˆ«ä¸å‘é‡æ¯ä¸€ä¸ªå…ƒç´ é€ä¸ªæ“ä½œï¼Œå¾—åˆ°ç»“æœ</li>
<li>å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ä¸ºç›¸åŒç»´åº¦ï¼Œæ¯ä¸ªç»´åº¦å¤§å°ç›¸åŒçš„å‘é‡ï¼Œåˆ™ç»“æœä¸ºå‘é‡æ¯ä¸¤ä¸ªå¯¹åº”ä½ç½®ä¸Šçš„å…ƒç´ çš„æ“ä½œå¾—åˆ°çš„ç»“æœ</li>
<li>å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ç»´åº¦ä¸ç›¸åŒï¼Œå¦‚æœå‘é‡ç»´åº¦æ•°ä¸º aã€bï¼Œå¹¶ä¸” a&gt;bï¼Œåˆ™ b çš„å„ç»´åº¦å¤§å°éœ€è¦ä¸ a çš„é«˜ç»´åº¦ç›¸å¯¹åº”ï¼Œä½ç»´å‘é‡åœ¨é«˜ç»´å‘é‡çš„ä½ç»´å±•å¼€ï¼Œæ“ä½œå¾—åˆ°ç»“æœ</li>
<li>é™¤ä¸Šé¢å‡ ç§æƒ…å†µï¼Œè°ƒç”¨ä¸åˆæ³•</li>
</ul>
</blockquote>
<p>å› æ­¤ï¼Œåœ¨é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ— éœ€å…³å¿ƒ â€œb+â€ã€â€œ1-â€ ç­‰æ“ä½œï¼Œè¿™äº›æ ‡é‡è‡ªç„¶ä¼šå±•å¼€åˆ°æ­£ç¡®çš„ç»´åº¦ã€‚åŒæ ·ï¼Œtf.log()ã€tf.sigmoid()å‡½æ•°ä¹Ÿä¼šå¯¹è¾“å…¥å‘é‡æ¯ä¸€ä¸ªå…ƒç´ é€ä¸ªæ“ä½œï¼Œä¸ä¼šæ”¹å˜å‘é‡çš„ç»´åº¦å’Œå¯¹åº”å€¼çš„ä½ç½®ã€‚</p>
<blockquote>
<p>å¯¹äºå¼å­ä¸­çš„æ±‚å’Œ Î£ï¼Œåœ¨ TensorFlow ä¸­æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š</p>
<ul>
<li>ä¸€ç§æ˜¯çŸ©é˜µä¹˜æ³• tf.matmul()ï¼Œå¦‚çŸ©é˜µ aã€bã€c å…³ç³»ä¸º c=tf.matmul(a,b)ï¼Œåˆ™å¯å¾—ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘ğ‘–ğ‘—=âˆ‘ğ‘˜ğ‘ğ‘–ğ‘˜ğ‘ğ‘˜ğ‘—cij=âˆ‘kaikbkj&#123;c*&#123;ij&#125;&#125; = \sum\limits_k &#123;&#123;a*&#123;ik&#125;&#125;&#123;b\_&#123;kj&#125;&#125;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li>å¦ä¸€ç§æ˜¯çŸ©é˜µå‹ç¼©å‡½æ•° tf.reduce_sum()ï¼ˆæ±‚å’Œï¼‰ã€tf.reduce_mean()ï¼ˆæ±‚å¹³å‡ï¼‰ç­‰å‡½æ•°ã€‚è¿™äº›å‡½æ•°é™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æ“ä½œçš„çŸ©é˜µå¤–ï¼Œè¿˜æœ‰å‡ ä¸ªå¾ˆæœ‰ç”¨çš„å‚æ•°ï¼šaxis æ˜¯è¦å‹ç¼©çš„ç»´åº¦ã€‚å¯¹äºä¸€ä¸ªäºŒç»´çŸ©é˜µæ¥è¯´ï¼Œå‹ç¼©ç»´åº¦ä¸º 0 æ„å‘³ç€å‹ç¼©è¡Œï¼Œç”Ÿæˆåˆ—å‘é‡ï¼Œå‹ç¼©ç»´åº¦ä¸º 1 æ„å‘³ç€å‹ç¼©åˆ—ï¼Œç”Ÿæˆè¡Œå‘é‡ï¼Œaxis=None æ„å‘³ç€å‹ç¼©æˆæ ‡é‡ï¼›keepdim æŒ‡å‹ç¼©åæ˜¯å¦ä¿æŒåŸæœ‰ç»´åº¦ï¼Œå¦‚æœ keepdims=Trueï¼Œæ“ä½œçŸ©é˜µè¢«å‹ç¼©çš„ç»´åº¦é•¿åº¦ä¼šä¿æŒï¼Œä½†é•¿åº¦ä¸€å®šæ˜¯ 1</li>
</ul>
</blockquote>
<p>åœ¨æŸå¤±å‡½æ•°ä¸­ï¼Œå…ˆçœ‹æœ€å¤–å±‚æ±‚å’Œé¡¹ï¼ˆä»¥ j æ±‚å’Œï¼‰ï¼Œå¯ä»¥çœ‹åš y ä¸ log å‡½æ•°çš„ç»“æœçš„é€é¡¹ç›¸ä¹˜æ±‚å’Œï¼Œå› æ­¤ log å‡½æ•°çš„è¾“å‡ºå‘é‡å½¢çŠ¶å¿…é¡»ä¸ y æˆ–è€… y çš„è½¬ç½®ä¸€è‡´ã€‚è€Œ log å‡½æ•°çš„è¾“å‡ºå‘é‡å½¢çŠ¶å–å†³äºå†…éƒ¨æ±‚å’Œé¡¹ï¼ˆä»¥ i æ±‚å’Œï¼‰ã€‚å¯ä»¥é€šè¿‡æ±‚å’Œå¼å¾—åˆ°åˆé€‚çš„è¿ç®—å½¢å¼ä¸º x*wï¼Œä¹Ÿå¯ä»¥é€šè¿‡å½¢çŠ¶æ¥æ¨ç†åˆé€‚çš„è¿ç®—å½¢å¼ï¼Œå³ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ‘¡ğ‘“.ğ‘šğ‘ğ‘¡ğ‘šğ‘¢ğ‘™(ğ‘¥,ğ‘¤)âˆˆğ‘…ğ‘šâˆ—1tf.matmul(x,w)âˆˆRmâˆ—1tf.matmul(x,w) \in &#123;R^&#123;m\*1&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åç»è¿‡ log å‡½æ•°å¾—åˆ°çš„ç»“æœä¸ y é€é¡¹ç›¸ä¹˜ï¼Œå†æ±‚å‹ç¼©å¹³å‡ï¼ˆæ­¤å¤„ä¹‹æ‰€ä»¥ä¸æ˜¯æ±‚å’Œè€Œæ˜¯æ±‚å¹³å‡ï¼Œæ˜¯ä¸ºäº†é¿å…æ ·æœ¬æ•°é‡å¯¹æŸå¤±å‡½æ•°ç»“æœäº§ç”Ÿå½±å“ï¼‰ï¼Œå¯ä»¥å¾—åˆ°å‡è®¾å‡½æ•°ã€ï¼ˆè´Ÿï¼‰ä¼¼ç„¶å‡½æ•°ã€æŸå¤±å‡½æ•°çš„è¿ç®—å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y_float = tf.to_float(y_expand)</span><br><span class="line">hypothesis = tf.sigmoid(tf.matmul(x, weight) + bais)</span><br><span class="line">likelyhood = -(y_float*tf.log(hypothesis) + (1.0-y_float)*(tf.log(1.0-hypothesis)))</span><br><span class="line">loss = tf.reduce_mean(likelyhood, axis=0)</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ä½¿ç”¨ TensorFlow çš„æŸå¤±å‡½æ•°è®¡ç®— loss</p>
<blockquote>
<p>TensorFlow çš„æŸå¤±å‡½æ•°ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼ˆä¸‹è¿°æ‰€æœ‰å…¬å¼å‡è®¾æ ·æœ¬æ•°åªæœ‰ä¸€ä¸ªï¼Œå¤šä¸ªçš„è¯éœ€è¦å–å¹³å‡ï¼‰ï¼š</p>
<ul>
<li>log_lossï¼šå³äº¤å‰ç†µè®¡ç®—ï¼Œè®¾æŸå¤±å‡½æ•° lï¼Œå‡è®¾å‡½æ•° hï¼Œæ ·æœ¬æ ‡ç­¾ yï¼ŒäºŒåˆ†ç±»æŸå¤±å…¬å¼å¦‚ä¸‹ï¼š</li>
</ul>
<p>ğ‘™=âˆ’ğ‘¦âˆ—log(â„)âˆ’(1âˆ’ğ‘¦)log(1âˆ’â„)l=âˆ’yâˆ—logâ¡(h)âˆ’(1âˆ’y)logâ¡(1âˆ’h)l =  - y*\log (h) - (1 - y)\log (1 - h)</p>
<p>å¤šåˆ†ç±»æŸå¤±å…¬å¼å¦‚ä¸‹ï¼Œæ³¨æ„å¯ä»¥æœ‰å¤šä¸ªåˆ†ç±»ï¼ˆåˆ†ç±»æ•°ä¸º cï¼‰ä¸ºæ­£ç¡®åˆ†ç±»ï¼š</p>
<p>ğ‘™=âˆ’âˆ‘ğ‘–ğ‘(ğ‘¦ğ‘–log(â„ğ‘–)âˆ’(1âˆ’ğ‘¦ğ‘–)log(1âˆ’â„ğ‘–))l=âˆ’âˆ‘ic(yilogâ¡(hi)âˆ’(1âˆ’yi)logâ¡(1âˆ’hi))l =  - \sum\limits_i^c {({y_i}\log ({h_i}) - (1 - {y_i})\log (1 - {h_i}))}</p>
<p>æ³¨æ„ä¸æ˜¯ä¸‹å¼ï¼Œè¿™é‡Œè·Ÿä¸€äº›å…¶ä»–åº“æœ‰åŒºåˆ«ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘™=âˆ’âˆ‘ğ‘–ğ‘ğ‘¦ğ‘–log(â„ğ‘–)l=âˆ’âˆ‘icyilogâ¡(hi)l =Â  - \sum\limits_i^c &#123;&#123;y_i&#125;\log (&#123;h_i&#125;)&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li>sigmoid_cross_entropyï¼šsigmoid + äº¤å‰ç†µï¼Œä¸ log_loss çš„å·®åˆ«åœ¨äºå…ˆå¯¹è¾“å…¥é¢„æµ‹å€¼æ±‚ sigmoid å‡½æ•°ï¼Œç„¶åå†è®¡ç®—äº¤å‰ç†µã€‚sigmoid å‡½æ•°å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘”(ğ‘§)=11+ğ‘’âˆ’ğ‘§g(z)=11+eâˆ’zg(z) = \frac&#123;1&#125;&#123;&#123;1 + &#123;e^&#123; - z&#125;&#125;&#125;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li>softmax_cross_entropyï¼šsoftmax + äº¤å‰ç†µï¼Œè®¾åˆ†ç±»æ€»æ•°ä¸º cï¼Œsoftmax å‡½æ•°å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘”(ğ‘§ğ‘–)=ğ‘’ğ‘§ğ‘–âˆ‘ğ‘—ğ‘ğ‘’ğ‘§ğ‘—g(zi)=eziâˆ‘jcezjg(&#123;z_i&#125;) = \frac&#123;&#123;&#123;e^&#123;&#123;z_i&#125;&#125;&#125;&#125;&#125;&#123;&#123;\sum\limits_j^c &#123;&#123;e^&#123;&#123;z_j&#125;&#125;&#125;&#125; &#125;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li><p>sparse_softmax_cross_entropyï¼šè®¡ç®—æ–¹å¼ä¸ softmax_cross_entropyï¼Œä½†è¾“å…¥æ ·æœ¬æ ‡ç­¾ä¸ºæ•´æ•°æ ‡ç­¾ï¼Œè€Œä¸æ˜¯ one-hot å½¢å¼ï¼Œè¿™æ˜¯å”¯ä¸€ä¸€ä¸ªè¾“å…¥ä¸¤ä¸ªå‚æ•°å„ç»´åº¦å¤§å°ä¸åŒçš„æŸå¤±å‡½æ•°</p>
</li>
<li><p>mean_squared_errorï¼šå‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼ŒæŸå¤±å…¬å¼å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<p>ğ‘™=(ğ‘¦âˆ’â„)2l=(yâˆ’h)2l = {(y - h)^2}</p>
<ul>
<li>huber_lossï¼šç”±äºå‡æ–¹è¯¯å·®å¯¹è¯¯å·®æ¯”è¾ƒå¤§çš„ç‚¹ç›¸å½“æ•æ„Ÿï¼Œä¸ºäº†æ§åˆ¶å¼‚å¸¸ç‚¹å¯¹æ¨¡å‹è®­ç»ƒçš„å½±å“ï¼Œhuber loss å¯¹è¯¯å·®æ¯”è¾ƒå°çš„æ ·æœ¬ç‚¹ä½¿ç”¨äºŒæ¬¡é¡¹è®¡ç®—æŸå¤±ï¼Œå¯¹è¯¯å·®æ¯”è¾ƒå¤§çš„æ ·æœ¬ç‚¹ä½¿ç”¨çº¿æ€§æ–¹ç¨‹è®¡ç®—æŸå¤±ï¼Œ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘™=&#123;12(ğ‘¦âˆ’â„)2,|ğ‘¦âˆ’â„|&lt;=ğ‘‘12ğ‘‘2+ğ‘‘(|ğ‘¦âˆ’â„|âˆ’ğ‘‘),|ğ‘¦âˆ’â„|&gt;ğ‘‘l=&#123;12(yâˆ’h)2,|yâˆ’h|&lt;=d12d2+d(|yâˆ’h|âˆ’d),|yâˆ’h|&gt;dl = \left\&#123; \begin&#123;array&#125;&#123;l&#125; \frac&#123;1&#125;&#123;2&#125;&#123;(y - h)^2&#125;,|y - h| &lt; = d\\ \frac&#123;1&#125;&#123;2&#125;&#123;d^2&#125; + d(|y - h| - d),|y - h| &gt; d \end&#123;array&#125; \right.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li>hinge_lossï¼šhinge loss ä¸å¤ªåœ¨æ„é¢„æµ‹çš„æœ‰å¤šå‡†ç¡®ï¼Œè€Œä¸»è¦æ¯”è¾ƒé¢„æµ‹æ­£ç¡®ç±»åˆ«ä¸é”™è¯¯ç±»åˆ«çš„é—´éš”ï¼Œè®¾æŸå¤±å‡½æ•° lï¼Œå‡è®¾å‡½æ•° hï¼Œæ ·æœ¬æ ‡ç­¾ yï¼ŒäºŒåˆ†ç±»æŸå¤±å…¬å¼å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘™=&#123;max(0,1âˆ’â„),ğ‘¦=1max(0,1+â„),ğ‘¦=0l=&#123;max(0,1âˆ’h),y=1max(0,1+h),y=0l = \left\&#123; \begin&#123;array&#125;&#123;l&#125; \max (0,1 - h),y = 1\\ \max (0,1 + h),y = 0 \end&#123;array&#125; \right.</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>è®¾æ­£ç¡®åˆ†ç±»ä¸º iï¼Œåˆ†ç±»æ€»æ•°ä¸º cï¼Œå¤šåˆ†ç±»æŸå¤±å…¬å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; ğ‘™=âˆ‘ğ‘—â‰ ğ‘–ğ‘max(0,1+â„ğ‘—âˆ’â„ğ‘–)l=âˆ‘jâ‰ icmax(0,1+hjâˆ’hi)l = \sum\limits\_&#123;j \ne i&#125;^c &#123;\max (0,1 + &#123;h_j&#125; - &#123;h_i&#125;)&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ­¤å¤„ï¼Œä½¿ç”¨ tf.losses.log_loss() æˆ–è€… tf.losses.sigmoid_cross_entropy() å¯ä»¥å¾—åˆ°ä¸ä¸Šé¢è¿ç®—å¼å®Œå…¨ç›¸åŒçš„ç»“æœï¼Œå³ï¼š</span><br></pre></td></tr></table></figure>
<p>hypothesis = tf.sigmoid(tf.matmul(x, weight) + bais)<br>loss = tf.losses.log_loss(y_expand, hypothesis)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æˆ–è€…</span><br></pre></td></tr></table></figure>
<p>hypothesis = tf.matmul(x, weight) + bais<br>loss = tf.losses.sigmoid_cross_entropy(y_expand, hypothesis)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç„¶ååˆ©ç”¨ TensorFlow çš„è‡ªåŠ¨å¾®åˆ†åŠŸèƒ½ï¼Œå³ä¼˜åŒ–ç±»ä¹‹ä¸€æ¥å®šä¹‰æ¨¡å‹çš„ä¼˜åŒ–è¿‡ç¨‹ï¼š</span><br></pre></td></tr></table></figure>
<p>LEARNING_RATE = 0.02<br>optimizer = tf.train.GradientDescentOptimizer(LEARNING_RATE)<br>training_op = optimizer.minimize(loss)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; TensorFlow çš„ä¼˜åŒ–ç±»ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; - GradientDescentOptimizerï¼šæœ€æ™®é€šçš„æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œä»¤å­¦ä¹ é€Ÿç‡ä¸º Î·ï¼Œt ä»£è¡¨æœ¬æ¬¡è¿­ä»£ï¼Œt+1 ä»£è¡¨ä¸‹æ¬¡è¿­ä»£ï¼Œåˆ™æ¢¯åº¦è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğœƒğ‘¡+1=ğœƒğ‘¡âˆ’ğœ‚âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒÎ¸t+1=Î¸tâˆ’Î·âˆ‚l(Î¸)âˆ‚Î¸&#123;\theta \_&#123;t + 1&#125;&#125; = &#123;\theta \_t&#125; - \eta \frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; - AdagradOptimizerï¼šè¿›è¡Œå‚æ•°è¿­ä»£çš„åŒæ—¶è®°å½•äº†æ¯ä¸ªå‚æ•°æ¯æ¬¡è¿­ä»£çš„æ¢¯åº¦çš„å¹³æ–¹å’Œï¼Œä¸‹æ¬¡è¿­ä»£æ—¶æ¢¯åº¦ä¸ç´¯ç§¯å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹æˆåæ¯”ã€‚è¿™æ ·ä¼šå¯¹ä½é¢‘çš„å‚æ•°åšè¾ƒå¤§çš„æ›´æ–°ï¼Œå¯¹é«˜é¢‘çš„å‚æ•°åšè¾ƒå°çš„æ›´æ–°ï¼Œå¯¹äºç¨€ç–æ•°æ®è¡¨ç°çš„æ›´å¥½ï¼›ä½†æ˜¯ç”±äºå­¦ä¹ é€Ÿç‡è¶Šæ¥è¶Šå°ï¼Œæœ‰å¯èƒ½æ²¡æœ‰åˆ°è¾¾æœ€ä½ç‚¹å­¦ä¹ é€Ÿç‡å°±å˜å¾—å¾ˆæ…¢äº†ï¼Œéš¾ä»¥æ”¶æ•›ã€‚ä»¤ s ä¸ºæ¢¯åº¦ç´¯ç§¯å¹³æ–¹å’Œï¼ŒÎµ ä¸ºæå°é‡ï¼Œt ä»£è¡¨æœ¬æ¬¡è¿­ä»£ï¼Œt-1 ä»£è¡¨ä¸Šæ¬¡è¿­ä»£ï¼Œt+1 ä»£è¡¨ä¸‹æ¬¡è¿­ä»£ï¼Œæ¢¯åº¦è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğ‘ ğ‘¡=ğ‘ ğ‘¡âˆ’1+(âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒ)2,ğœƒğ‘¡+1=ğœƒğ‘¡âˆ’ğœ‚ğ‘ ğ‘¡+ğœ€â€¾â€¾â€¾â€¾â€¾â€¾âˆšâˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒst=stâˆ’1+(âˆ‚l(Î¸)âˆ‚Î¸)2,Î¸t+1=Î¸tâˆ’Î·st+Îµâˆ‚l(Î¸)âˆ‚Î¸&#123;s*t&#125; = &#123;s*&#123;t - 1&#125;&#125; + &#123;(\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;)^2&#125;,&#123;\theta \_&#123;t + 1&#125;&#125; = &#123;\theta \_t&#125; - \frac&#123;\eta &#125;&#123;&#123;\sqrt &#123;&#123;s_t&#125; + \varepsilon &#125; &#125;&#125;\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; - RMSPropOptimizerï¼šä¸ºè§£å†³ AdagradOptimizer åæœŸæ›´æ–°é€Ÿç‡è¿‡æ…¢çš„é—®é¢˜ï¼ŒRMSprop ä½¿ç”¨åŠ æƒç´¯ç§¯å¹³æ–¹å’Œæ›¿æ¢ç´¯ç§¯å¹³æ–¹å’Œã€‚ä»¤ m ä»£è¡¨æ¢¯åº¦åŠ æƒç´¯ç§¯å¹³æ–¹å’Œï¼ŒÎµ ä¸ºæå°é‡ï¼ŒÎ² ä¸ºæƒé‡ï¼Œt ä»£è¡¨æœ¬æ¬¡è¿­ä»£ï¼Œt-1 ä»£è¡¨ä¸Šæ¬¡è¿­ä»£ï¼Œt+1 ä»£è¡¨ä¸‹æ¬¡è¿­ä»£ï¼Œæ¢¯åº¦è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğ‘šğ‘¡=ğ›½ğ‘šğ‘¡âˆ’1+(1âˆ’ğ›½)(âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒ)2,ğœƒğ‘¡+1=ğœƒğ‘¡âˆ’ğœ‚ğ‘šğ‘¡+ğœ€â€¾â€¾â€¾â€¾â€¾â€¾âˆšâˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒmt=Î²mtâˆ’1+(1âˆ’Î²)(âˆ‚l(Î¸)âˆ‚Î¸)2,Î¸t+1=Î¸tâˆ’Î·mt+Îµâˆ‚l(Î¸)âˆ‚Î¸&#123;m*t&#125; = \beta &#123;m*&#123;t - 1&#125;&#125; + (1 - \beta )&#123;(\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;)^2&#125;,&#123;\theta \_&#123;t + 1&#125;&#125; = &#123;\theta \_t&#125; - \frac&#123;\eta &#125;&#123;&#123;\sqrt &#123;&#123;m_t&#125; + \varepsilon &#125; &#125;&#125;\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; - MomentumOptimizerï¼šå¤šä¸€ä¸ªå¿…é¡»å‚æ•° â€œåŠ¨é‡é€Ÿç‡â€ï¼Œæ¯æ¬¡è¿­ä»£æ—¶å‚è€ƒå‰ä¸€æ¬¡è¿­ä»£çš„ â€œåŠ¨é‡â€ï¼Œåœ¨è¿­ä»£ä¸­æ–¹å‘ä¸å˜çš„ç»´åº¦åšè¾ƒå¤§çš„æ›´æ–°ï¼Œè¿­ä»£ä¸­æ–¹å‘åå¤æ”¹å˜çš„ç»´åº¦åšè¾ƒå°çš„æ›´æ–°ã€‚é€‚ç”¨äºåœ¨ä¸åŒç»´åº¦æ¢¯åº¦å·®è·å¾ˆå¤§çš„æƒ…å†µï¼Œæ›´æ–°ä¸ä¼šåœ¨å°æ¢¯åº¦æ–¹å‘åå¤éœ‡è¡ã€‚ä»¤ Î³ ä»£è¡¨åŠ¨é‡é€Ÿç‡ï¼Œt ä»£è¡¨æœ¬æ¬¡è¿­ä»£ï¼Œt-1 ä»£è¡¨ä¸Šæ¬¡è¿­ä»£ï¼Œt+1 ä»£è¡¨ä¸‹æ¬¡è¿­ä»£ï¼Œæ¢¯åº¦è¿­ä»£å…¬å¼å¦‚ä¸‹ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğ‘£ğ‘¡=ğ›¾ğ‘£ğ‘¡âˆ’1+ğœ‚âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒ,ğœƒğ‘¡+1=ğœƒğ‘¡âˆ’ğ‘£ğ‘¡vt=Î³vtâˆ’1+Î·âˆ‚l(Î¸)âˆ‚Î¸,Î¸t+1=Î¸tâˆ’vt&#123;v*t&#125; = \gamma &#123;v*&#123;t - 1&#125;&#125; + \eta \frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;,&#123;\theta \_&#123;t + 1&#125;&#125; = &#123;\theta \_t&#125; - &#123;v_t&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; - AdamOptimizerï¼šç»¼åˆäº† MomentumOptimizer å’Œ RMSPropOptimizerï¼Œæ—¢åŒ…å«åŠ¨é‡ï¼ˆä¸€æ¬¡é¡¹ï¼‰éƒ¨åˆ†ä¹ŸåŒ…å«è¡°å‡ï¼ˆä¸¤æ¬¡é¡¹ï¼‰éƒ¨åˆ†ã€‚ä»¤ f ä»£è¡¨åŠ¨é‡ï¼Œg ä»£è¡¨è¡°å‡ï¼ŒÎ²1ã€Î²2 ä¸ºæƒé‡ï¼Œt ä»£è¡¨æœ¬æ¬¡è¿­ä»£ï¼Œt-1 ä»£è¡¨ä¸Šæ¬¡è¿­ä»£ï¼Œt+1 ä»£è¡¨ä¸‹æ¬¡è¿­ä»£ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğ‘“ğ‘¡=ğ›½2ğ‘“ğ‘¡âˆ’1+(1âˆ’ğ›½2)âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒğ‘”ğ‘¡=ğ›½1ğ‘”ğ‘¡âˆ’1+(1âˆ’ğ›½1)(âˆ‚ğ‘™(ğœƒ)âˆ‚ğœƒ)2ft=Î²2ftâˆ’1+(1âˆ’Î²2)âˆ‚l(Î¸)âˆ‚Î¸gt=Î²1gtâˆ’1+(1âˆ’Î²1)(âˆ‚l(Î¸)âˆ‚Î¸)2\begin&#123;array&#125;&#123;l&#125; &#123;f*t&#125; = &#123;\beta \_2&#125;&#123;f*&#123;t - 1&#125;&#125; + (1 - &#123;\beta _2&#125;)\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;\\ &#123;g_t&#125; = &#123;\beta \_1&#125;&#123;g_&#123;t - 1&#125;&#125; + (1 - &#123;\beta \_1&#125;)&#123;(\frac&#123;&#123;\partial l(\theta )&#125;&#125;&#123;&#123;\partial \theta &#125;&#125;)^2&#125; \end&#123;array&#125;</span><br><span class="line">&gt;</span><br><span class="line">&gt; æ³¨æ„æ­¤å¤„ç¬¬ä¸€æ¬¡è¿­ä»£çš„æ¢¯åº¦å€¼å’Œé€Ÿç‡å€¼åå°ï¼Œä¸ºäº†æ ¡æ­£åå·®ï¼Œè®¡ç®—æ ¡æ­£åçš„åŠ¨é‡ fâ€²å’Œè¡°å‡ gâ€²ï¼Œå†è®¡ç®—è¿­ä»£å…¬å¼ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; ğ‘“â€²ğ‘¡=ğ‘“ğ‘¡1âˆ’ğ›½1ğ‘”â€²ğ‘¡=ğ‘”ğ‘¡1âˆ’ğ›½2ğœƒğ‘¡+1=ğœƒğ‘¡âˆ’ğœ‚ğ‘”â€²ğ‘¡+ğœ€âˆšğ‘“â€²ğ‘¡fâ€²t=ft1âˆ’Î²1gâ€²t=gt1âˆ’Î²2Î¸t+1=Î¸tâˆ’Î·gâ€²t+Îµfâ€²t\begin&#123;array&#125;&#123;l&#125; &#123;&#123;f&apos;&#125;_t&#125; = \frac&#123;&#123;&#123;f_t&#125;&#125;&#125;&#123;&#123;1 - &#123;\beta _1&#125;&#125;&#125;\\ &#123;&#123;g&apos;&#125;_t&#125; = \frac&#123;&#123;&#123;g_t&#125;&#125;&#125;&#123;&#123;1 - &#123;\beta _2&#125;&#125;&#125;\\ &#123;\theta \_&#123;t + 1&#125;&#125; = &#123;\theta \_t&#125; - \frac&#123;\eta &#125;&#123;&#123;\sqrt &#123;&#123;&#123;g&apos;&#125;_t&#125; + \varepsilon &#125; &#125;&#125;&#123;&#123;f&apos;&#125;\_t&#125; \end&#123;array&#125;</span><br><span class="line"></span><br><span class="line">æœ€åè¿˜éœ€è¦ä¸€ä¸ªé¢„æµ‹æ“ä½œå’Œå‡†ç¡®ç‡åˆ¤æ–­æ“ä½œï¼š</span><br></pre></td></tr></table></figure>
<p>THRESHOLD = 0.5<br>predictions = tf.sign(hypothesis-THRESHOLD) #ç¬¦å·å‡½æ•°ï¼Œåˆ¤æ–­å‘é‡å¯¹åº”ä½ç½®çš„ç¬¦å·ï¼Œè¾“å‡ºå¯¹åº”ä½ç½®ä¸º-1ã€0 æˆ– 1<br>labels = tf.sign(y_float-THRESHOLD)<br>corrections = tf.equal(predictions, labels) #æ¯”è¾ƒå‘é‡å¯¹åº”ä½ç½®çš„ä¸¤ä¸ªå€¼ï¼Œç›¸ç­‰åˆ™è¾“å‡ºå¯¹åº”ä½ç½®ä¸º True<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼š</span><br></pre></td></tr></table></figure>
<p>THRESHOLD = 0.5<br>predictions = tf.to_int32(hypothesis-THRESHOLD)<br>corrections = tf.equal(predictions, y_expand)<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å®Œæ•´ä»£ç ï¼ˆåŒ…æ‹¬æµ‹è¯•è¿è¡Œä»£ç ï¼‰å¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure>
<p>tf.reset_default_graph() #æ¸…ç©º Graph</p>
<p>FEATURE_NUM = 8 #ç‰¹å¾æ•°é‡<br>with tf.name_scope(â€œinputâ€):<br>x = tf.placeholder(tf.float32, shape=[None, FEATURE_NUM])<br>y = tf.placeholder(tf.int32, shape=[None])</p>
<p>with tf.name_scope(â€œlrâ€):<br>weight_init = tf.truncated_normal(shape=[FEATURE_NUM, 1],mean=0.0,stddev=1.0)<br>weight = tf.Variable(weight_init)<br>bais = tf.Variable([0.0])</p>
<pre><code>y_expand = tf.expand_dims(y, axis=1)

hypothesis = tf.sigmoid(tf.matmul(x, weight) + bais)
</code></pre><p>with tf.name_scope(â€œlossâ€):<br>y_float = tf.to_float(y_expand)<br>likelyhood = -(y_float<em>tf.log(hypothesis) + (1.0-y_float)</em>(tf.log(1.0-hypothesis)))<br>loss = tf.reduce_mean(likelyhood, axis=0)</p>
<p>LEARNING_RATE = 0.02 #å­¦ä¹ é€Ÿç‡<br>with tf.name_scope(â€œtrainâ€):<br>optimizer = tf.train.GradientDescentOptimizer(LEARNING_RATE)<br>training_op = optimizer.minimize(loss)</p>
<p>THRESHOLD = 0.5 #åˆ¤æ–­é—¨é™<br>with tf.name_scope(â€œevalâ€):<br>predictions = tf.sign(hypothesis-THRESHOLD)<br>labels = tf.sign(y_float-THRESHOLD)<br>corrections = tf.equal(predictions, labels)<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<p>init = tf.global_variables_initializer() #åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>EPOCH = 10 #è¿­ä»£æ¬¡æ•°<br>with tf.Session() as sess:<br>sess.run(init)<br>for i in range(EPOCH):<br>_training_op, _loss = sess.run([training_op, loss], feed_dict={x: np.random.rand(10,8), y: np.random.randint(2,size=10)})<br>_accuracy = sess.run([accuracy], feed_dict={x: np.random.rand(5,8), y: np.random.randint(2,size=5)})<br>print â€œepoch:â€, i, _loss, _accuracy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">7ï¼ŒFM çš„ TensorFlow å®ç°</span><br><span class="line"></span><br><span class="line">åŒæ ·ï¼Œå…ˆå®šä¹‰å˜é‡å ä½ç¬¦ï¼š</span><br></pre></td></tr></table></figure>
<p>FEATURE_NUM = 8 #ç‰¹å¾æ•°é‡<br>x = tf.placeholder(tf.float32, shape=[None, FEATURE_NUM])<br>y = tf.placeholder(tf.int32, shape=[None])<br>y_exband = tf.expand_dims(y, axis=1)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç„¶åå®ç°å‡è®¾å‡½æ•°ï¼š</span><br></pre></td></tr></table></figure>
<pre><code>ğ‘™(ğ‘,ğ‘¤,ğ‘£)=âˆ’âˆ‘ğ‘—=1ğ‘š(ğ‘¦(ğ‘—)log(â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—))+(1âˆ’ğ‘¦(ğ‘—))log(1âˆ’â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—)))â„(ğ‘¤,ğ‘)|ğ‘¥=ğ‘¥(ğ‘—)=ğ‘”(ğ‘+âˆ‘ğ‘–=1ğ‘›ğ‘¤ğ‘–ğ‘¥(ğ‘—)ğ‘–+12âˆ‘ğ‘Ÿ=1ğ‘˜((âˆ‘ğ‘–=1ğ‘›ğ‘£ğ‘–ğ‘Ÿğ‘¥(ğ‘—)ğ‘–)2âˆ’âˆ‘ğ‘–=1ğ‘›(ğ‘£ğ‘–ğ‘Ÿğ‘¥(ğ‘—)ğ‘–)2))l(b,w,v)=âˆ’âˆ‘j=1m(y(j)logâ¡(h(w,b)|x=x(j))+(1âˆ’y(j))logâ¡(1âˆ’h(w,b)|x=x(j)))h(w,b)|x=x(j)=g(b+âˆ‘i=1nwixi(j)+12âˆ‘r=1k((âˆ‘i=1nvirxi(j))2âˆ’âˆ‘i=1n(virxi(j))2))\begin{array}{l} l(b,w,v) = - \sum\limits*{j = 1}^m {({y^{(j)}}\log (h(w,b){|*{x = {x^{(j)}}}}) + (1 - {y^{(j)}})\log (1 - h(w,b){|_{x = {x^{(j)}}}}))} \\ h(w,b){|_{x = {x^{(j)}}}} = g(b + \sum\limits*{i = 1}^n {{w_i}x_i^{(j)}} + \frac{1}{2}\sum\limits*{r = 1}^k {({{(\sum\limits_{i = 1}^n {{v_{ir}}x*i^{(j)}} )}^2} - \sum\limits*{i = 1}^n {{{({v_{ir}}x_i^{(j)})}^2}} )} ) \end{array}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å…ˆå®šä¹‰æ¨¡å‹æƒé‡ï¼š</span><br></pre></td></tr></table></figure>
<p>HIDDEN_N = 5<br>bais = tf.Variable([0.0])<br>weight = tf.Variable(tf.random_normal([FEATURE_N, 1], 0.0, 1.0))<br>weight_mix = tf.Variable(tf.random_normal([FEATURE_N, HIDDEN_N], 0.0, 1.0))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä¸€æ¬¡é¡¹å’Œé›¶æ¬¡é¡¹æ¯”è¾ƒå¥½è®¡ç®—ï¼Œè·Ÿ LR ä¸€æ ·ï¼Œä½†äºŒæ¬¡é¡¹å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚è¿™é‡Œçš„è®¡ç®—è¿‡ç¨‹ï¼Œä¸€äº›å¹¿ä¸ºæµä¼ çš„åšå®¢ä¸Šä»£ç éƒ½æ˜¯é”™çš„ã€‚</span><br><span class="line"></span><br><span class="line">é¦–å…ˆå¯çŸ¥ï¼š</span><br></pre></td></tr></table></figure>
<p>ğ‘¥âˆˆğ‘…ğ‘šâˆ—ğ‘›,ğ‘£âˆˆğ‘…ğ‘›âˆ—ğ‘˜,ğ‘¦âˆˆğ‘…ğ‘šâˆ—1xâˆˆRmâˆ—n,vâˆˆRnâˆ—k,yâˆˆRmâˆ—1x \in {R^{m<em>n}},v \in {R^{n</em>k}},y \in {R^{m*1}}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å…ˆå°è¯•çŸ©é˜µä¹˜æ³•é™ç»´ï¼Œå¯å¾—ï¼š</span><br></pre></td></tr></table></figure>
<p>ğ‘¥ğ‘£âˆˆğ‘…ğ‘šâˆ—ğ‘˜,(ğ‘¥ğ‘£)ğ‘ğ‘=âˆ‘ğ‘–=1ğ‘›ğ‘¥(ğ‘)ğ‘–ğ‘£ğ‘–ğ‘xvâˆˆRmâˆ—k,(xv)ab=âˆ‘i=1nxi(a)vibxv \in {R^{m*k}},{(xv)<em>{ab}} = \sum\limits</em>{i = 1}^n {x<em>i^{(a)}{v</em>{ib}}}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¯è§æ­£å¥½ä¸äºŒæ¬¡é¡¹çš„ç¬¬ä¸€é¡¹å½¢å¼ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¡ç®—ç¬¬ä¸€é¡¹ï¼Œä¸€ä¸ª m\*k çš„çŸ©é˜µï¼Œå¾—åˆ°ç»“æœåå¯ä»¥é€šè¿‡å…ˆå‹ç¼©ç¬¬ 1 ç»´å†å‹ç¼©ç¬¬ 0 ç»´ï¼Œå¾—åˆ°æŸå¤±å‡½æ•°ç»“æœï¼ˆ0 ç»´æ ‡é‡ï¼‰</span><br></pre></td></tr></table></figure>
<p>x_weight_mix = tf.matmul(x, weight_mix)<br>x_weight_mix_square = tf.square(x_weight_mix)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä½†è§‚å¯ŸäºŒæ¬¡é¡¹çš„ç¬¬äºŒé¡¹ï¼Œå°±æ²¡è¿™ä¹ˆç®€å•äº†ï¼Œå»é™¤ç»´åº¦æ— å…³çš„åŠ æ³•ã€å‡æ³•ã€log ç­‰æ“ä½œçš„å½±å“ï¼Œç¬¬äºŒé¡¹ç­‰åŒäºè®¡ç®—å¦‚ä¸‹å¼å­ï¼š</span><br></pre></td></tr></table></figure>
<pre><code>âˆ‘ğ‘—=1ğ‘šâˆ‘ğ‘Ÿ=1ğ‘˜âˆ‘ğ‘–=1ğ‘›(ğ‘¥(ğ‘—)ğ‘–ğ‘£ğ‘–ğ‘Ÿ)2âˆ‘j=1mâˆ‘r=1kâˆ‘i=1n(xi(j)vir)2\sum\limits*{j = 1}^m {\sum\limits*{r = 1}^k {\sum\limits*{i = 1}^n {{{(x_i^{(j)}{v*{ir}})}^2}} } }
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å³éœ€è¦å¾—åˆ°æ¯ä¸ª jã€rã€i çš„ç»„åˆï¼Œå†å¹³æ–¹ï¼Œå†ä¾æ¬¡æ±‚å’Œï¼Œå¯çŸ¥è¿™å¿…é¡»æ˜¯ä¸€ä¸ªä¸‰ç»´çŸ©é˜µæ‰èƒ½å®Œæˆè¿ç®—ã€‚å› æ­¤ï¼Œå¦‚æœèƒ½è®¾è®¡ä¸€ä¸ªä¸‰ç»´çŸ©é˜µ d æ»¡è¶³å¦‚ä¸‹å°±æ¡ä»¶ï¼Œå°±å¥½è®¡ç®—äº†ï¼š</span><br></pre></td></tr></table></figure>
<p>ğ‘‘ğ‘—ğ‘Ÿğ‘–=ğ‘¥(ğ‘—)ğ‘–ğ‘£ğ‘–ğ‘Ÿ,ğ‘‘âˆˆğ‘…ğ‘šâˆ—ğ‘˜âˆ—ğ‘›djri=xi(j)vir,dâˆˆRmâˆ—kâˆ—n{d<em>{jri}} = x_i^{(j)}{v</em>{ir}},d \in {R^{m<em>k</em>n}}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºä¸‰ç»´çŸ©é˜µ d çš„æ¯é¡¹ä¸æ¶‰åŠæ±‚å’Œï¼Œåªæœ‰ä¸¤ä¸ªæ•°ç›¸ä¹˜ï¼Œå› æ­¤æœ€ç›´æ¥çš„æ–¹å¼æ˜¯æ‰©å±• xã€v çš„ç»´åº¦ä¸ d ç›¸åŒï¼Œç„¶åç›´æ¥é€é¡¹ç›¸ä¹˜ï¼Œä¸ºæ–¹ä¾¿è®¡ç®—ï¼Œè°ƒæ•´ä¸‰ç»´çŸ©é˜µ d çš„å®šä¹‰ï¼š</span><br></pre></td></tr></table></figure>
<p>ğ‘‘ğ‘—ğ‘–ğ‘Ÿ=ğ‘¥(ğ‘—)ğ‘–ğ‘£ğ‘–ğ‘Ÿ,ğ‘‘âˆˆğ‘…ğ‘šâˆ—ğ‘›âˆ—ğ‘˜djir=xi(j)vir,dâˆˆRmâˆ—nâˆ—k{d<em>{jir}} = x_i^{(j)}{v</em>{ir}},d \in {R^{m<em>n</em>k}}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™æ ·ï¼Œx åœ¨ç¬¬ 2 ç»´æ‰©å±•ï¼Œv åœ¨ç¬¬ 0 ä¸ºæ‰©å±•ï¼Œé€é¡¹ç›¸ä¹˜ç»“æœå³ä¸º dï¼š</span><br></pre></td></tr></table></figure>
<p>ğ‘‘ğ‘—ğ‘–ğ‘Ÿ=ğ‘¥(ğ‘›ğ‘’ğ‘¤),(ğ‘—)ğ‘–ğ‘Ÿğ‘£(ğ‘›ğ‘’ğ‘¤),ğ‘—ğ‘–ğ‘Ÿ,ğ‘‘âˆˆğ‘…ğ‘šâˆ—ğ‘›âˆ—ğ‘˜ğ‘¥(ğ‘›ğ‘’ğ‘¤),(ğ‘—)ğ‘–ğ‘Ÿ=ğ‘¥(ğ‘—)ğ‘–,ğ‘¥(ğ‘›ğ‘’ğ‘¤)âˆˆğ‘…ğ‘šâˆ—ğ‘›âˆ—ğ‘˜ğ‘£(ğ‘›ğ‘’ğ‘¤),ğ‘—ğ‘–ğ‘Ÿ=ğ‘£ğ‘–ğ‘Ÿ,ğ‘£(ğ‘›ğ‘’ğ‘¤)âˆˆğ‘…ğ‘šâˆ—ğ‘›âˆ—ğ‘˜djir=x(new),ir(j)v(new),jir,dâˆˆRmâˆ—nâˆ—kx(new),ir(j)=xi(j),x(new)âˆˆRmâˆ—nâˆ—kv(new),jir=vir,v(new)âˆˆRmâˆ—nâˆ—k\begin{array}{l} {d<em>{jir}} = {x</em>{(new),}}<em>{ir}^{(j)}{v</em>{(new)}}<em>{,jir},d \in {R^{m<em>n</em>k}}\ {x</em>{(new),}}<em>{ir}^{(j)} = x_i^{(j)},{x</em>{(new)}} \in {R^{m<em>n</em>k}}\ {v<em>{(new)}}</em>{,jir} = {v<em>{ir}},{v</em>{(new)}} \in {R^{m<em>n</em>k}} \end{array}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™é‡Œéœ€è¦ç”¨åˆ° tf.tile() å’Œ tf.reshape()ï¼Œtf.tile() çš„åŠŸèƒ½æ˜¯å°†çŸ©é˜µçš„æŸä¸€ç»´ï¼ˆæˆ–è€… n ç»´ï¼‰çš„æ•°æ®é‡å¤æ•°æ¬¡ï¼Œtf.reshape() å¯ä»¥å°†ä¸¤ç»´å‘é‡å˜ä¸ºä¸‰ç»´çŸ©é˜µã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœå…ˆ tile å† reshapeï¼Œå…¶å®æ˜¯å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼Œä¾‹å¦‚å°† x çš„ç¬¬ 2 ç»´æ‰©å±• k æ¬¡ï¼Œå¯å¾—ï¼š</span><br><span class="line"></span><br><span class="line">ğ‘¥(ğ‘¡ğ‘–ğ‘™ğ‘’)âˆˆğ‘…ğ‘šâˆ—(ğ‘›âˆ—ğ‘˜)x(tile)âˆˆRmâˆ—(nâˆ—k)&#123;x\_&#123;(tile)&#125;&#125; \in &#123;R^&#123;m*(n*k)&#125;&#125;</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ï¼Œåˆ°åº• x(tile) ç»è¿‡ â€œåˆé€‚çš„â€reshape å‡ç»´åæ˜¯ m*n*k ç»´çŸ©é˜µè¿˜æ˜¯ m*k*n ç»´çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªéš¾ä»¥ç›´æ¥åˆ¤æ–­çš„é—®é¢˜ï¼Œå› æ­¤ï¼Œæœ€å¥½å…ˆ reshapeï¼ˆæˆ–è€… expand_dimsï¼‰ï¼Œå† tileã€‚äºŒæ¬¡é¡¹çš„ç¬¬äºŒé¡¹è®¡ç®—æ–¹å¼å¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure>
<p>SAMPLE<em>N = tf.shape(x)[0]<br>x</em> = tf.reshape(x, [SAMPLE<em>N,FEATURE_N,1]) #SAMPLE<em>N</em>FEATURE_N*1<br>x\</em>_ = tf.tile(x<em>, [1,1,HIDDEN_N]) #SAMPLE</em>N<em>FEATURE_N</em>HIDDEN<em>N<br>w<em> = tf.reshape(weight</em>mix, [1,FEATURE_N,HIDDEN_N]) #1<em>FEATURE_N</em>HIDDEN_N<br>w\</em>_ = tf.tile(x<em>, [SAMPLE_N,1,1]) #SAMPLE_N</em>FEATURE_N<em>HIDDEN_N<br>embeddings = tf.multiply(x<strong>, w</strong>) #SAMPLE_N</em>FEATURE_N<em>HIDDEN_N<br>embeddings_square = tf.square(embeddings) #SAMPLE_N</em>FEATURE_N<em>HIDDEN_N<br>embeddings_square_sum = tf.reduce_sum(embeddings_square, 1) #SAMPLE_N\</em>HIDDEN_N</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ­¤æ—¶ï¼Œå¯ä»¥å‘ç°ï¼Œæ„é€ å‡º embeddings çŸ©é˜µåï¼ŒäºŒæ¬¡é¡¹çš„ç¬¬ä¸€é¡¹ä¹Ÿå¯ä»¥é€šè¿‡ embeddings æ¥è®¡ç®—ï¼š</span><br></pre></td></tr></table></figure>
<p>embeddings_sum = tf.reduce_sum(embeddings, 1) #SAMPLE_N<em>HIDDENT_N<br>embeddings_sum_square = tf.square(embeddings_sum) #SAMPLE_N</em>HIDDENT_N</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç„¶åå°†æŸå¤±å‡½æ•°çš„é›¶æ¬¡é¡¹ã€ä¸€æ¬¡é¡¹ã€äºŒæ¬¡é¡¹ç»„åˆèµ·æ¥ï¼Œå¯å¾—æŸå¤±å‡½æ•°ï¼š</span><br></pre></td></tr></table></figure>
<p>z = bais + tf.matmul(X, weight) + 1.0/2.0*tf.reduce_sum(tf.subtract(embeddings_sum_square,embeddings_square_sum), 1, keepdims=True)<br>hypothesis = tf.sigmoid(z)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™é‡Œå¯ä»¥å‘ç°ï¼Œz çš„è®¡ç®—å…¬å¼ä¸­åŒ…å«å¤§é‡äºŒæ¬¡é¡¹çš„æ±‚å’Œï¼Œç»å¯¹å€¼å¾ˆå¯èƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œæ­¤æ—¶å†ç»è¿‡ sigmoid å‡½æ•°ï¼Œç”±äºæµ®ç‚¹æ•°è¡¨è¾¾ç²¾åº¦æœ‰é™ï¼Œç»“æœå¯èƒ½ä¼šè¿‘ä¼¼ç­‰äº 1 æˆ–ç­‰äº 0ï¼Œé€ æˆæ¨¡å‹æ— æ³•æ›´æ–°ï¼Œå› æ­¤æ­¤å¤„éœ€è¦ä½¿ç”¨ tf.clip_by_value() å¯¹ z è¿›è¡Œæˆªæ–­ï¼Œé˜²æ­¢è¶…å‡ºç²¾åº¦ï¼š</span><br></pre></td></tr></table></figure>
<p>z = bais + tf.matmul(x, weight) + 1.0/2.0*tf.reduce<em>sum(tf.subtract(embeddings_sum_square,embeddings_square_sum), 1, keepdims=True)<br>z</em> = tf.clip<em>by_value(z,-4.0,4.0)<br>hypothesis = tf.sigmoid(z</em>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥ä¼˜åŒ–è¿‡ç¨‹ä¸åˆ¤æ–­è¿‡ç¨‹ä¸ LR åŸºæœ¬ä¸€æ ·ï¼Œå¯å¾—å®Œæ•´ä»£ç ï¼ˆåŒ…æ‹¬æµ‹è¯•è¿è¡Œä»£ç ï¼‰å¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure>
<p>tf.reset_default_graph() #æ¸…ç©º Graph</p>
<p>FEATURE_NUM = 8 #ç‰¹å¾æ•°é‡<br>with tf.name_scope(â€œinputâ€):<br>x = tf.placeholder(tf.float32, shape=[None, FEATURE_NUM])<br>y = tf.placeholder(tf.int32, shape=[None])<br>y_expand = tf.expand_dims(y, axis=1)</p>
<p>HIDDEN_NUM = 5 #éšè—ç‰¹å¾ç»´åº¦<br>with tf.name_scope(â€œfmâ€):<br>bais = tf.Variable([0.0])<br>weight = tf.Variable(tf.random_normal([FEATURE_NUM, 1], 0.0, 1.0))<br>weight_mix = tf.Variable(tf.random_normal([FEATURE_NUM, HIDDEN_NUM], 0.0, 1.0))</p>
<pre><code>SAMPLE_NUM = tf.shape(x)[0]  #è·å–æ ·æœ¬æ•°

x_ = tf.reshape(x, [SAMPLE_NUM,FEATURE_NUM,1]) #SAMPLE_NUM*FEATURE_NUM*1
x__ = tf.tile(x_, [1,1,HIDDEN_NUM]) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
w_ = tf.reshape(weight_mix, [1,FEATURE_NUM,HIDDEN_NUM]) #1*FEATURE_NUM*HIDDEN_NUM
w__ = tf.tile(w_, [SAMPLE_NUM,1,1]) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM

embeddings = tf.multiply(x__, w__) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
embeddings_sum = tf.reduce_sum(embeddings, 1) #SAMPLE_NUM*HIDDEN_NUM
embeddings_sum_square = tf.square(embeddings_sum) #SAMPLE_NUM*HIDDEN_NUM
embeddings_square = tf.square(embeddings) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
embeddings_square_sum = tf.reduce_sum(embeddings_square, 1) #SAMPLE_NUM*HIDDEN_NUM

z = bais + tf.matmul(x, weight) + 1.0/2.0*tf.reduce_sum(tf.subtract(embeddings_sum_square,embeddings_square_sum), 1, keepdims=True)
z_ = tf.clip_by_value(z,-4.0,4.0)
hypothesis  = tf.sigmoid(z_)
</code></pre><p>with tf.name_scope(â€œlossâ€):<br>loss = tf.losses.log_loss(y_expand, hypothesis)</p>
<p>LEARNING_RATE = 0.02 #å­¦ä¹ é€Ÿç‡<br>with tf.name_scope(â€œtrainâ€):<br>optimizer = tf.train.GradientDescentOptimizer(LEARNING_RATE)<br>training_op = optimizer.minimize(loss)</p>
<p>THRESHOLD = 0.5 #åˆ¤æ–­é—¨é™<br>with tf.name_scope(â€œevalâ€):<br>predictions = tf.to_int32(hypothesis-THRESHOLD)<br>corrections = tf.equal(predictions, y_expand)<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<p>init = tf.global_variables_initializer() #åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>EPOCH = 10 #è¿­ä»£æ¬¡æ•°<br>with tf.Session() as sess:<br>sess.run(init)<br>for i in range(EPOCH):<br>_training_op, _loss = sess.run([training_op, loss], feed_dict={x: np.random.rand(10,8), y: np.random.randint(2,size=10)})<br>_accuracy = sess.run([accuracy], feed_dict={x: np.random.rand(5,8), y: np.random.randint(2,size=5)})<br>print â€œepoch:â€, i, _loss, _accuracy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä½†æ˜¯è¿™æ—¶å¯ä»¥å‘ç°ï¼Œæ¨¡å‹æœ¬èº«å·²ç»æ¯”è¾ƒå¤æ‚äº†ï¼Œå…¶ä¸­åŒ…å«äº†è‹¥å¹²å˜é‡ï¼Œåœ¨åµŒå…¥å·¥ç¨‹ï¼Œæˆ–è€…ä½œä¸ºæ¨¡å‹ä¸­çš„ä¸€ä¸ªæ¨¡å—åµŒå…¥ç½‘ç»œä¸­æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šé€ æˆå˜é‡åç§°çš„æ··ä¹±ï¼Œå¹¶ä¸”ä¹Ÿä¸åˆ©äºç”Ÿæˆæ˜æ™°çš„ç½‘ç»œç»“æ„ï¼Œå› æ­¤ï¼Œè¿™é‡Œè€ƒè™‘å°† FM æ„å»ºç½‘ç»œéƒ¨åˆ†åŒ…è£¹æˆå‡½æ•°æˆ–è€…ç±»ï¼š</span><br></pre></td></tr></table></figure>
<h1 id="FM-æ¨¡å‹"><a href="#FM-æ¨¡å‹" class="headerlink" title="FM æ¨¡å‹"></a>FM æ¨¡å‹</h1><p>class FmModel(object):<br>def <strong>init</strong>(self, x, y, feature_num, hidden_num):<br>self.x = x<br>self.y = y<br>self.feature_num = feature_num #è·å–ç‰¹å¾æ•°ï¼Œè¿™ä¸ªå€¼è¦å»º Variableï¼Œæ‰€ä»¥ä¸èƒ½åŠ¨æ€è·å–<br>self.sample_num = tf.shape(x)[0] #è·å–æ ·æœ¬æ•°<br>self.hidden_num = hidden_num #è·å–éšè—ç‰¹å¾ç»´åº¦</p>
<pre><code>    self.bais = tf.Variable([0.0])
    self.weight = tf.Variable(tf.random_normal([self.feature_num, 1], 0.0, 1.0))
    self.weight_mix = tf.Variable(tf.random_normal([self.feature_num, self.hidden_num], 0.0, 1.0))

    x_ = tf.reshape(self.x, [self.sample_num,self.feature_num,1]) #SAMPLE_NUM*FEATURE_NUM*1
    x__ = tf.tile(x_, [1,1,self.hidden_num]) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
    w_ = tf.reshape(self.weight_mix, [1,self.feature_num,self.hidden_num]) #1*FEATURE_NUM*HIDDEN_NUM
    w__ = tf.tile(w_, [self.sample_num,1,1]) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM

    embeddings = tf.multiply(x__, w__) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
    embeddings_sum = tf.reduce_sum(embeddings, 1) #SAMPLE_NUM*HIDDEN_NUM
    embeddings_sum_square = tf.square(embeddings_sum) #SAMPLE_NUM*HIDDEN_NUM
    embeddings_square = tf.square(embeddings) #SAMPLE_NUM*FEATURE_NUM*HIDDEN_NUM
    embeddings_square_sum = tf.reduce_sum(embeddings_square, 1) #SAMPLE_NUM*HIDDEN_NUM

    z = self.bais + tf.matmul(self.x, self.weight) + 1.0/2.0*tf.reduce_sum(tf.subtract(embeddings_sum_square,embeddings_square_sum), 1, keepdims=True)
    z_ = tf.clip_by_value(z,-4.0,4.0)

    self.hypothesis  = tf.sigmoid(z_)
    y_expand = tf.expand_dims(self.y, axis=1)
    self.loss = tf.losses.log_loss(y_expand, self.hypothesis)
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œæ— è®ºä½¿ç”¨ç±»ä¹Ÿå¥½ï¼Œå‡½æ•°ä¹Ÿå¥½ï¼Œå…¶ä¸­å¾ˆå¤šå˜é‡ä»å…¨å±€å˜é‡å˜ä¸ºäº†å±€éƒ¨å˜é‡ï¼Œå‡½æ•°æ‰§è¡Œå®Œå˜é‡å°±è¢«é”€æ¯äº†ã€‚ä½†åªè¦æ‰§è¡Œå®Œä¸€æ¬¡ï¼Œç½‘ç»œå°±å·²ç»å»ºç«‹èµ·æ¥äº†ï¼Œå˜é‡çš„ç”Ÿå­˜æœŸå¹¶ä¸å½±å“ç½‘ç»œèŠ‚ç‚¹çš„ç”Ÿå­˜æœŸã€‚è¿™æ—¶åˆæ¶‰åŠåˆ°å¦ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•åœ¨ Session ä¸­æƒ³è¦å¾—åˆ°è¿™äº›ç±»æˆ–å‡½æ•°ä¸­å®šä¹‰çš„ç½‘ç»œèŠ‚ç‚¹çš„å€¼ã€‚</span><br><span class="line"></span><br><span class="line">&gt; TensorFlow ä¸­ä¼šè¯è¿è¡Œç½‘ç»œèŠ‚ç‚¹çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; - ä½¿ç”¨ç½‘ç»œå»ºç«‹è¿‡ç¨‹ä¸­ï¼Œä»å¤„äºç”Ÿå­˜æœŸå†…çš„ python å˜é‡ã€‚è¿™æ ·åšæœ‰ä¸¤ä¸ªå±€é™æ€§ï¼Œä¸€ç§æƒ…å†µæ˜¯ python å˜é‡ç”Ÿå­˜æœŸå¤–å°±æ— æ³•ä½¿ç”¨ï¼Œå¦ä¸€æƒ…å†µæ˜¯å¦‚æœæ¨¡å‹åŠ è½½è‡ªå·²ç»è®­ç»ƒå¥½çš„ç½‘ç»œï¼Œæ²¡æœ‰å¯¹åº”èŠ‚ç‚¹çš„ python å˜é‡ã€‚</span><br><span class="line">&gt; - ä½¿ç”¨ç½‘ç»œä¸­çš„èŠ‚ç‚¹åï¼Œèµ‹ç»™ python å˜é‡ã€‚TensorFlow ä¸­çš„ Tensor éƒ½å¯ä»¥åœ¨å®šä¹‰æ—¶æ·»åŠ ä¸€ä¸ªé™„åŠ å‚æ•° nameï¼Œå¯ä»¥é€šè¿‡ tf.get_default_graph().get_tensor_by_name() æ¥è·å–ç½‘ç»œä¸­ä»»ä½•çš„èŠ‚ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚ä¸Šä¾‹ä¸­å¦‚æœè¦è·å– embeddings å˜é‡çš„å€¼ï¼Œå¯ä»¥å¦‚æ­¤æ“ä½œï¼š</span><br></pre></td></tr></table></figure>
<h1 id="FM-æ¨¡å‹-1"><a href="#FM-æ¨¡å‹-1" class="headerlink" title="FM æ¨¡å‹"></a>FM æ¨¡å‹</h1><p>class FmModel(object):<br>def <strong>init</strong>(self, x, y, feature_num, hidden_num):<br>â€¦<br>embeddings = tf.multiply(x<strong>, w</strong>, ) #SAMPLE_NUM<em>FEATURE_NUM</em>HIDDEN_NUM<br>â€¦</p>
<p>HIDDEN_NUM = 5 #éšè—ç‰¹å¾ç»´åº¦<br>with tf.name_scope(â€œfmâ€):<br>fm = FmModel(x, y, FEATURE_NUM, HIDDEN_NUM)</p>
<p>embeddings = tf.get_default_graph().get_tensor_by_name(â€œfm/embeddings:0â€) #æ³¨æ„ name_scope ä¸åé¢çš„å†’å·å’Œåºå·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä½¿ç”¨ FmModel ç±»çš„å®Œæ•´ä»£ç ï¼ˆåŒ…æ‹¬æµ‹è¯•è¿è¡Œä»£ç ï¼‰å¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure>
<p>tf.reset_default_graph() #æ¸…ç©º Graph</p>
<p>FEATURE_NUM = 8 #ç‰¹å¾æ•°é‡<br>with tf.name_scope(â€œinputâ€):<br>x = tf.placeholder(tf.float32, shape=[None, FEATURE_NUM])<br>y = tf.placeholder(tf.int32, shape=[None])</p>
<p>HIDDEN_NUM = 5 #éšè—ç‰¹å¾ç»´åº¦<br>with tf.name_scope(â€œfmâ€):<br>fm = FmModel(x, y, FEATURE_NUM, HIDDEN_NUM)</p>
<p>LEARNING_RATE = 0.02 #å­¦ä¹ é€Ÿç‡<br>with tf.name_scope(â€œtrainâ€):<br>optimizer = tf.train.GradientDescentOptimizer(LEARNING_RATE)<br>training_op = optimizer.minimize(fm.loss)</p>
<p>THRESHOLD = 0.5 #åˆ¤æ–­é—¨é™<br>with tf.name_scope(â€œevalâ€):<br>y_expand = tf.expand_dims(y, axis=1)<br>predictions = tf.to_int32(fm.hypothesis-THRESHOLD)<br>corrections = tf.equal(predictions, fm.y_expand)<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<p>init = tf.global_variables_initializer() #åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>EPOCH = 10 #è¿­ä»£æ¬¡æ•°<br>with tf.Session() as sess:<br>sess.run(init)<br>for i in range(EPOCH):<br>_training_op, _loss = sess.run([training_op, fm.loss], feed_dict={x: np.random.rand(10,8), y: np.random.randint(2,size=10)})<br>_accuracy = sess.run([accuracy], feed_dict={x: np.random.rand(5,8), y: np.random.randint(2,size=5)})<br>print â€œepoch:â€, i, _loss, _accuracy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">7ï¼Œç¨€ç– FM çš„ TensorFlow å®ç°</span><br><span class="line"></span><br><span class="line">ä¸Šè¿° TensorFlow å®ç°ä¸­ä½¿ç”¨äº†ä¸å°‘äºŒç»´ç”šè‡³ä¸‰ç»´çš„çŸ©é˜µè¿ç®—ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨ FM æ¨¡å‹çš„æ ·æœ¬æ•°æ®å¾€å¾€æ˜¯ç»´æ•°å·¨å¤§å¹¶ä¸”ç¨€ç–çš„ï¼Œè¿™æ—¶ç›´æ¥ä½¿ç”¨çŸ©é˜µä¹˜æ³•ä¼šå ç”¨å¤§é‡çš„ç³»ç»Ÿèµ„æºã€æµªè´¹å¤§é‡çš„è¿ç®—æ—¶é—´ã€‚</span><br><span class="line"></span><br><span class="line">é’ˆå¯¹ç¨€ç–çŸ©é˜µä¹˜æ³•ï¼ŒTensorFlow æœ‰ä¸€ç§ä¸“é—¨çš„æ–¹å¼ç®€åŒ–è¿ç®—è¿‡ç¨‹ã€‚æ­¤æ—¶è¦ç”¨åˆ° tf.nn.embedding_lookup()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„è¾“å…¥ä¸€ä¸ªå‚æ•°çŸ©é˜µ w å’Œä¸€ä¸ªç¨€ç–ç´¢å¼•çŸ©é˜µ iï¼Œä½œç”¨æ˜¯åœ¨åœ¨å‚æ•°çŸ©é˜µ w çš„ç¬¬ä¸€ç»´ä¸­æŸ¥æ‰¾ç´¢å¼•çŸ©é˜µ i ä¸­å„å€¼å¯¹åº”çš„ â€œè¡Œâ€ï¼ŒæŠ½å–å‡ºç´¢å¼•å€¼å¯¹åº”çš„â€œä¸€è¡Œâ€ å‚æ•°ï¼Œæ”¾åˆ°ç´¢å¼•çŸ©é˜µä¸­å¯¹åº”ä½ç½®ï¼Œç»„åˆä¸ºæœ‰æ•ˆç‰¹å¾å¯¹åº”çš„å‚æ•°çŸ©é˜µã€‚å¯çŸ¥ç´¢å¼•çŸ©é˜µçš„å€¼å¿…é¡»å°äº w ç¬¬ä¸€ç»´çš„å¤§å°ï¼Œç»“æœç»´æ•°ç­‰äº w çš„ç»´æ•°ä¸ i çš„ç»´æ•°ä¹‹å’Œå‡ä¸€ã€‚</span><br><span class="line"></span><br><span class="line">ç”±äºæœ‰æ•ˆç‰¹å¾çŸ©é˜µä¼šå‚ä¸çŸ©é˜µè¿ç®—ï¼ŒçŸ©é˜µè¿ç®—ä¸­ä¸èƒ½å‡ºç°æ¯è¡Œé•¿åº¦ä¸åŒçš„æƒ…å†µï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ä¸€ç‚¹å±€é™æ€§ï¼Œå°±æ˜¯æ¯ä¸ªæ ·æœ¬çš„æœ‰æ•ˆç‰¹å¾æ•°å¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœå¤šäº†éœ€è¦æˆªå–ï¼Œå¦‚æœå°‘äº†éœ€è¦è¡¥é›¶ã€‚</span><br><span class="line"></span><br><span class="line">é’ˆå¯¹ç¨€ç–ç‰¹å¾çš„ FM å®Œæ•´ä»£ç ï¼ˆåŒ…æ‹¬æµ‹è¯•è¿è¡Œä»£ç ï¼‰å¦‚ä¸‹ï¼š</span><br></pre></td></tr></table></figure>
<h1 id="FM-æ¨¡å‹-2"><a href="#FM-æ¨¡å‹-2" class="headerlink" title="FM æ¨¡å‹"></a>FM æ¨¡å‹</h1><p>class FmModel(object):<br>def <strong>init</strong>(self, i, x, y, feature_num, valid_num, hidden_num):<br>self.i = i<br>self.x = x<br>self.y = y<br>self.feature_num = feature_num #è·å–ç‰¹å¾æ•°ï¼Œè¿™ä¸ªå€¼è¦å»º Variableï¼Œæ‰€ä»¥ä¸èƒ½åŠ¨æ€è·å–<br>self.valid_num = valid_num #è·å–æœ‰æ•ˆç‰¹å¾æ•°ï¼Œè¿™ä¸ªå€¼è¦å»º Variableï¼Œæ‰€ä»¥ä¸èƒ½åŠ¨æ€è·å–<br>self.sample_num = tf.shape(x)[0] #è·å–æ ·æœ¬æ•°<br>self.hidden_num = hidden_num #è·å–éšè—ç‰¹å¾ç»´åº¦</p>
<pre><code>    self.bais = tf.Variable([0.0])
    self.weight = tf.Variable(tf.random_normal([self.feature_num, 1], 0.0, 1.0))
    self.weight_mix = tf.Variable(tf.random_normal([self.feature_num, self.hidden_num], 0.0, 1.0))

    x_ = tf.reshape(self.x, [self.sample_num,self.valid_num,1]) #SAMPLE_NUM*VALID_NUM*1
    w_ = tf.nn.embedding_lookup(self.weight, self.i) #SAMPLE_NUM*VALID_NUM*1

    expressings = tf.multiply(x_, w_) #SAMPLE_NUM*VALID_NUM*1
    expressings_reduce = tf.reshape(self.x, [self.sample_num,self.valid_num]) #SAMPLE_NUM*VALID_NUM

    x__ = tf.tile(x_, [1,1,self.hidden_num]) #SAMPLE_NUM*VALID_NUM*HIDDEN_NUM
    w__ = tf.nn.embedding_lookup(self.weight_mix, self.i) #SAMPLE_NUM*VALID_NUM*HIDDEN_NUM

    embeddings = tf.multiply(x__, w__) #SAMPLE_NUM*VALID_NUM*HIDDEN_NUM
    embeddings_sum = tf.reduce_sum(embeddings, 1) #SAMPLE_NUM*HIDDEN_NUM
    embeddings_sum_square = tf.square(embeddings_sum) #SAMPLE_NUM*HIDDEN_NUM
    embeddings_square = tf.square(embeddings) #SAMPLE_NUM*VALID_NUM*HIDDEN_NUM
    embeddings_square_sum = tf.reduce_sum(embeddings_square, 1) #SAMPLE_NUM*HIDDEN_NUM

    z = self.bais + \
        tf.reduce_sum(expressings_reduce, 1, keepdims=True) + \
        1.0/2.0*tf.reduce_sum(tf.subtract(embeddings_sum_square,embeddings_square_sum), 1, keepdims=True)
    z_ = tf.clip_by_value(z,-4.0,4.0)

    self.hypothesis  = tf.sigmoid(z_)

    self.y_expand = tf.expand_dims(self.y, axis=1)

    self.loss = tf.losses.log_loss(self.y_expand, self.hypothesis)
</code></pre><p>tf.reset_default_graph() #æ¸…ç©º Graph</p>
<p>VALID_NUM = 8 #æœ‰æ•ˆç‰¹å¾æ•°é‡<br>with tf.name_scope(â€œinputâ€):<br>i = tf.placeholder(tf.int32, shape=[None, VALID_NUM])<br>x = tf.placeholder(tf.float32, shape=[None, VALID_NUM])<br>y = tf.placeholder(tf.int32, shape=[None])<br>y_expand = tf.expand_dims(y, axis=1)</p>
<p>FEATURE_NUM = 20 #ç‰¹å¾æ•°é‡<br>HIDDEN_NUM = 5 #éšè—ç‰¹å¾ç»´åº¦<br>with tf.name_scope(â€œfmâ€):<br>fm = FmModel(i, x, y, FEATURE_NUM, VALID_NUM, HIDDEN_NUM)</p>
<p>LEARNING_RATE = 0.02 #å­¦ä¹ é€Ÿç‡<br>with tf.name_scope(â€œtrainâ€):<br>optimizer = tf.train.GradientDescentOptimizer(LEARNING_RATE)<br>training_op = optimizer.minimize(fm.loss)</p>
<p>THRESHOLD = 0.5 #åˆ¤æ–­é—¨é™<br>with tf.name_scope(â€œevalâ€):<br>predictions = tf.to_int32(fm.hypothesis-THRESHOLD)<br>corrections = tf.equal(predictions, fm.y_expand)<br>accuracy = tf.reduce_mean(tf.cast(corrections, tf.float32))</p>
<p>init = tf.global_variables_initializer() #åˆå§‹åŒ–æ‰€æœ‰å˜é‡</p>
<p>EPOCH = 10 #è¿­ä»£æ¬¡æ•°<br>with tf.Session() as sess:<br>sess.run(init)<br>for epoch in range(EPOCH):<br>_training_op, _loss = sess.run([training_op, fm.loss],<br>feed_dict={i: np.array([np.random.choice(20, 8) for cnt in range(10)]), x: np.random.rand(10,8), y: np.random.randint(2,size=10)})<br>_accuracy = sess.run([accuracy],<br>feed_dict={i: np.array([np.random.choice(20, 8) for cnt in range(5)]), x: np.random.rand(5,8), y: np.random.randint(2,size=5)})<br>print â€œepoch:â€, epoch, _loss, _accuracy</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å‚è€ƒæ–‡çŒ®ï¼š</span><br><span class="line"></span><br><span class="line">https://www.cnblogs.com/pinard/p/6370127.html</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>AILab-aida</li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://ailab-aida.github.io/2019/10/31/FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£/" title="FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£">https://ailab-aida.github.io/2019/10/31/FMï¼ˆFactorization Machineï¼‰å› å¼åˆ†è§£æœº ä¸ TensorFlow å®ç° è¯¦è§£/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/ç®—æ³•/" rel="tag"># ç®—æ³•</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/10/30/å„ç±»é™ç»´æ–¹æ³•æ€»ç»“/" rel="next" title="å„ç±»é™ç»´æ–¹æ³•æ€»ç»“">
                  <i class="fa fa-chevron-left"></i> å„ç±»é™ç»´æ–¹æ³•æ€»ç»“
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/11/04/è¯å‘é‡_word2vec åº”ç”¨ç¯‡/" rel="prev" title="è¯å‘é‡word2vec">
                  è¯å‘é‡word2vec <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#FM-æ¨¡å‹"><span class="nav-number">1.</span> <span class="nav-text">FM æ¨¡å‹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FM-æ¨¡å‹-1"><span class="nav-number">2.</span> <span class="nav-text">FM æ¨¡å‹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FM-æ¨¡å‹-2"><span class="nav-number">3.</span> <span class="nav-text">FM æ¨¡å‹</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="AILab-aida">
  <p class="site-author-name" itemprop="name">AILab-aida</p>
  <div class="site-description" itemprop="description">æ¶‰çŒçš„ä¸»è¦ç¼–ç¨‹è¯­è¨€ä¸º æ·±åº¦å­¦ä¹ ã€æœºå™¨å­¦ä¹ ã€å¤§æ•°æ®ã€æœåŠ¡ç«¯ã€ç§»åŠ¨ç«¯ã€å‰ç«¯ã€çˆ¬è™«(goã€scalaã€Javaã€flutterã€Pythonã€reactã€Vue)ç­‰ã€‚</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/qq1074123922" title="GitHub &rarr; https://github.com/qq1074123922" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/1074123922@qq.com" title="E-Mail &rarr; 1074123922@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">AILab-aida</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="/lib/pjax/pjax.min.js?v=0.2.8"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var id = element.id || '';
    var src = element.src || '';
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (id !=='') {
      script.id = element.id;
    }
    if (src !== '') {
      script.src = src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  








  <script src="/js/local-search.js?v=7.4.0"></script>













    <div id="pjax">

  

  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: 'a6d340a24e0f5044ffc3',
      clientSecret: 'edff6432acd3e21caff2696cc123e15b3ca3461c',
      repo: 'ailab-aida.github.io',
      owner: 'AILab-aida',
      admin: ['ailab'],
      id: '9f943e985acfd95936632e90724ec361',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>

    </div>
</body>
</html>
